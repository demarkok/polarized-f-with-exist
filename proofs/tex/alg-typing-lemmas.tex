Let us extend the declarative typing metric (\cref{def:decl-typing-metric}) 
to the algorithmic typing.

\begin{definition}[Size of an Algorithmic Judgement]

    \label{def:algorithmic-typing-size}
    For an algorithmic typing judgement $J$
    let us define a metrics $\size{J}$ as a pair of numbers 
    in the following way:
    \begin{itemize}
        \item [$+$] $\size{[[Γ ; Φ ⊨ v : iP]]} = (\size{[[v]]}, 0)$;
        \item [$-$] $\size{[[Γ ; Φ ⊨ c : iN]]} = (\size{[[c]]}, 0)$;
        \item [$\bullet$] $\size{[[Γ ; Φ ; Θ ⊨ uN ● args ⇒> uM ⫤ Θ'; SC]]} = 
            (\size{[[args]]}, \npq{[[uN]]})$)
    \end{itemize}
\end{definition}

\begin{definition}[Metric]
    We extend the metric from \cref{def:decl-typing-metric} to the algorithmic typing
    in the following way.
    For a tree $T$ inferring an algorithmic typing judgement $J$, we define 
    $\size{T}$ as $(\size{J}, 0)$.
\end{definition}

Soundness and the completeness are proved by mutual induction on
the metric of the inference tree.

\begin{lemma}[Soundness of typing] \label{lemma:typing-soundness}
    Suppose that $[[Γ ⊢ Φ]]$.
    For an inference tree $T_1$,
    \hfill
    \begin{itemize}
        \item [$+$] If $T_1$ infers $[[Γ; Φ ⊨ v : iP]]$ then $[[Γ ⊢ iP]]$ and $[[Γ; Φ ⊢ v : iP]]$
        \item [$-$] If $T_1$ infers $[[Γ; Φ ⊨ c : iN]]$ then $[[Γ ⊢ iN]]$ and $[[Γ; Φ ⊢ c : iN]]$
        \item  If $T_1$ infers $[[Γ; Φ; Θ ⊨ uN ● args ⇒> uM ⫤ Θ'; SC]]$
                for $[[Γ ⊢ Θ]]$ and $[[Γ; dom(Θ) ⊢  uN]]$ free from negative algorithmic variables, 
                then
            \begin{enumerate}
                \item $[[Γ ⊢ Θ']]$
                \item $[[Θ ⊆ Θ']]$
                \item $[[Γ; dom(Θ') ⊢  uM]]$
                \item $[[dom(Θ) ∩ uv(uM) ⊆ uv uN]]$
                \item $[[uM]]$ is normalized and free from negative algorithmic variables
                \item $[[Θ'|uv uN ∪ uv uM ⊢ SC]]$
                \item for any $[[ Θ' ⊢ uσ : uv uN ∪ uv uM ]]$,
                    $[[ Θ' ⊢ uσ : SC ]]$ implies $[[ Γ ; Φ ⊢ [uσ]uN ● args ⇒> [uσ]uM ]]$
            \end{enumerate}
    \end{itemize}
\end{lemma}
\begin{proof}
    We prove it by induction on $\metric{T_1}$, mutually with 
    the completeness of typing (\cref{lemma:typing-soundness}).
    Let us consider the last rule used to infer the derivation.
    \begin{caseof}
        \item \ruleref{\ottdruleATVarLabel}
            We are proving that if $[[Γ; Φ ⊨ x : nf(iP)]]$
            then $[[Γ ⊢ nf(iP)]]$ and $[[Γ; Φ ⊢ x : nf(iP)]]$.

            By inversion, $[[x : iP ∊ Φ]]$.
            Since $[[Γ ⊢ Φ]]$, we have $[[Γ ⊢ iP]]$,
            and by \cref{corollary:wf-nf}, $[[Γ ⊢ nf(iP)]]$.

            By applying \ruleref{\ottdruleDTVarLabel}
            to $[[x : iP ∊ Φ]]$, we infer $[[Γ; Φ ⊢ x : iP]]$.
            Finally, by \ruleref{\ottdruleDTPEquivLabel}, 
            since $[[Γ ⊢ iP ≈ nf(iP)]]$ 
            (\cref{corollary:nf-sound-wrt-subt-equiv}),
            we have $[[Γ; Φ ⊢ x : nf(iP)]]$.

        \item \ruleref{\ottdruleATThunkLabel}
            \label{case:typing-soundness:thunk}

            We are proving that if $[[Γ; Φ ⊨ {c} : ↓iN]]$
            then $[[Γ ⊢ ↓iN]]$ and $[[Γ; Φ ⊢ {c} : ↓iN]]$.

            By inversion of $[[Γ; Φ ⊨ {c} : ↓iN]]$, 
            we have $[[Γ; Φ ⊨ c : iN]]$.
            By the induction hypothesis applied to $[[Γ; Φ ⊨ c : iN]]$,
            we have 
            \begin{enumerate}
                \item $[[Γ ⊢ iN]]$, and hence, $[[Γ ⊢ ↓iN]]$;
                \item $[[Γ; Φ ⊢ c : iN]]$, 
                    which by \ruleref{\ottdruleDTThunkLabel} implies
                    $[[Γ; Φ ⊢ {c} : ↓iN]]$.
            \end{enumerate}

        \item \ruleref{\ottdruleATReturnLabel}
            The proof is symmetric to the previous case
            (\cref{case:typing-soundness:thunk}).

        \item \ruleref{\ottdruleATPAnnotLabel}
            \label{case:typing-soundness:pos-annot}
            We are proving that if $[[Γ; Φ ⊨ (v : iQ) : nf(iQ)]]$
            then $[[Γ ⊢ nf(iQ)]]$ and $[[Γ; Φ ⊢ (v : iQ) : nf(iQ)]]$.

            By inversion of $[[Γ; Φ ⊨ (v : iQ) : nf(iQ)]]$,
            we have:
            \begin{enumerate}
                \item $[[Γ ⊢ (v : iQ)]]$, hence, $[[Γ ⊢ iQ]]$, 
                    and by \cref{corollary:wf-nf}, $[[Γ ⊢ nf(iQ)]]$;
                \item $[[Γ; Φ ⊨ v : iP]]$, 
                    which by the induction hypothesis implies
                    $[[Γ ⊢ iP]]$ and $[[Γ; Φ ⊢ v : iP]]$;
                \item $[[Γ ; · ⊨ uQ ≥ iP ⫤ ·]]$,
                    which by \cref{lemma:pos-subt-soundness} implies
                    $[[Γ ⊢ [·]uQ ≥ iP]]$, that is $[[Γ ⊢ iQ ≥ iP]]$.
            \end{enumerate}

            To infer 
            $[[Γ; Φ ⊢ (v : iQ) : iQ]]$, 
            we apply \ruleref{\ottdruleDTPAnnotLabel} 
            to $[[Γ; Φ ⊢ v : iP]]$ and $[[Γ ⊢ iQ ≥ iP]]$.
            Then by \ruleref{\ottdruleDTPEquivLabel},
            $[[Γ; Φ ⊢ (v : iQ) : nf(iQ)]]$.
  
        \item \ruleref{\ottdruleATNAnnotLabel}
            The proof is symmetric to the previous case
            (\cref{case:typing-soundness:pos-annot}).

        \item \ruleref{\ottdruleATtLamLabel}
            We are proving that if 
            $[[Γ; Φ ⊨ λx:iP . c : nf(iP → iN)]]$
            then 
            $[[Γ ⊢ nf(iP → iN)]]$ and
            $[[Γ; Φ ⊢ λx:iP . c : nf(iP → iN)]]$.


            By inversion of $[[Γ; Φ ⊨ λx:iP . c : nf(iP → iN)]]$,
            we have $[[Γ ⊢ λx:iP . c]]$, 
            which implies $[[Γ ⊢ iP]]$.

            Also by inversion of $[[Γ; Φ ⊨ λx:iP . c : nf(iP → iN)]]$,
            we have $[[Γ; Φ, x:iP ⊨ c : iN]]$, applying induction 
            hypothesis to which gives us:
            \begin{enumerate}
                \item  $[[Γ ⊢ iN]]$, thus $[[Γ ⊢ iP → iN]]$, 
                    and by \cref{corollary:wf-nf}, $[[Γ ⊢ nf(iP → iN)]]$;
                \item $[[Γ; Φ, x:iP ⊢ c : iN]]$, 
                    which by \ruleref{\ottdruleDTtLamLabel} implies
                    $[[Γ; Φ ⊢ λx:iP . c : iP → iN]]$, 
                    and by \ruleref{\ottdruleDTPEquivLabel},
                    $[[Γ; Φ ⊢ λx:iP . c : nf(iP → iN)]]$.
            \end{enumerate}

        \item \ruleref{\ottdruleATTLamLabel}
            We are proving that if
            $[[Γ; Φ ⊨ Λα⁺ . c : nf(∀α⁺.iN)]]$
            then 
            $[[Γ ; Φ ⊢ Λα⁺ . c : nf(∀α⁺.iN)]]$
            and
            $[[Γ ⊢ nf(∀α⁺.iN)]]$.

            
            By inversion of $[[Γ, α⁺ ; Φ ⊨ c : iN]]$,
            we have $[[Γ ⊢ Λα⁺ . c]]$, which implies $[[Γ, α⁺ ⊢ c]]$.

            Also by inversion of 
            $[[Γ, α⁺ ; Φ ⊨ c : iN]]$, 
            we have $[[Γ, α⁺ ; Φ ⊨ c : iN]]$. 
            Obtaining the induction hypothesis to $[[Γ, α⁺ ; Φ ⊨ c : iN]]$,
            we have:
            \begin{enumerate}
                \item $[[Γ, α⁺ ⊢ iN]]$, thus $[[Γ ⊢ ∀α⁺.iN]]$,
                    and by \cref{corollary:wf-nf}, $[[Γ ⊢ nf(∀α⁺.iN)]]$;
                \item $[[Γ, α⁺ ; Φ ⊢ c : iN]]$, 
                    which by \ruleref{\ottdruleDTTLamLabel} implies
                    $[[Γ ; Φ ⊢ Λα⁺ . c : ∀α⁺.iN]]$, 
                    and by \ruleref{\ottdruleDTPEquivLabel},
                    $[[Γ ; Φ ⊢ Λα⁺ . c : nf(∀α⁺.iN)]]$.
            \end{enumerate}
            
        \item \ruleref{\ottdruleATVarLetLabel}
            We are proving that if
            $[[Γ; Φ ⊨ let x = v ; c : iN]]$
            then
            $[[Γ ; Φ ⊢ let x = v ; c : iN]]$ and 
            $[[Γ ⊢ iN]]$.


            By inversion of 
            $[[Γ; Φ ⊨ let x = v ; c : iN]]$,
            we have:
            \begin{enumerate}
                \item $[[Γ ⊢ let x = v ; c]]$, which gives us 
            $[[Γ ⊢ v]]$ and $[[Γ ⊢ c]]$.
                \item $[[Γ; Φ ⊨ v : iP]]$, 
                    which by the induction hypothesis implies
                    $[[Γ ⊢ iP]]$ (and thus, $[[Γ ⊢ Φ, x:iP]]$) 
                    and $[[Γ; Φ ⊢ v : iP]]$; 
                \item $[[Γ; Φ, x:iP ⊨ c : iN]]$, 
                    which by the induction hypothesis implies
                    $[[Γ ⊢ iN]]$ and $[[Γ; Φ, x:iP ⊢ c : iN]]$.
            \end{enumerate}
            This way, 
            $[[Γ; Φ ⊢ let x = v ; c : iN]]$ holds by
            \ruleref{\ottdruleDTVarLetLabel}.

        \item \ruleref{\ottdruleATAppLetAnnLabel}
            We are proving that 
            if
            $[[Γ; Φ ⊨ let x:iP = v(args); c' : iN]]$
            then 
            $[[Γ ; Φ ⊢ let x:iP = v(args); c' : iN]]$ and
            $[[Γ ⊢ iN]]$.

            By inversion, we have:
            \begin{enumerate}
                \item $[[Γ ⊢ iP]]$, hence, $[[Γ ⊢ Φ, x:iP]]$
                \item $[[Γ; Φ ⊨ v : ↓iM]]$
                \item $[[Γ; Φ; · ⊨ uM ● args ⇒> ↑uQ ⫤ Θ; SC1]]$
                \item $[[Γ; Θ ⊨ ↑uQ ≤ ↑iP ⫤ SC2]]$
                \item $[[Θ ⊢ SC1 & SC2 = SC]]$
                \item $[[Γ; Φ, x:iP ⊨ c' : iN]]$
            \end{enumerate}

            By the induction hypothesis applied to $[[Γ; Φ ⊨ v : ↓iM]]$, we have
            $[[Γ; Φ ⊢ v : ↓iM]]$ and $[[Γ ⊢ ↓iM]]$ (and hence, $[[Γ ; dom(Θ) ⊢  uM]]$).

            By the induction hypothesis applied to $[[Γ; Φ, x:iP ⊨ c' : iN]]$, we have
            $[[Γ; Φ, x:iP ⊢ c' : iN]]$ and $[[Γ ⊢ iN]]$. 

            By the induction hypothesis applied to $[[Γ; Φ; · ⊨ uM ● args ⇒> ↑uQ ⫤ Θ; SC1]]$, we have:
            \begin{enumerate}
                \item \label{typing-soundness:theta-wf} $[[Γ ⊢ Θ]]$,
                \item $[[Γ; dom(Θ) ⊢ ↑uQ]]$,
                \item $[[Θ'|uv uM ∪ uv uQ ⊢ SC1]]$,
                    and thus, $[[dom(SC1) ⊆ uv uM ∪ uv uQ]]$.
                \item \label{typing-soundness:SC1-initiality} 
                    for any $[[ Θ' ⊢ uσ : SC1 ]]$, we have $[[ Γ ; Φ ⊢ [uσ]uM ● args ⇒> [uσ]↑uQ ]]$.
            \end{enumerate}

            By soundness of negative subtyping (\cref{lemma:neg-subtyping-soundness})
            applied to $[[Γ; Θ ⊨ ↑uQ ≤ ↑iP ⫤ SC2]]$, we have
            $[[Θ ⊢ SC2 : uv(↑uQ)]]$, and thus, $[[uv(↑uQ) = dom(SC2)]]$.

            By soundness of constraint merge (\cref{lemma:merge-soundness}),
            $[[dom(SC) = dom(SC1) ∪ dom(SC2)]] \subseteq [[uv uM ∪ uv uQ]]$
            Then by \cref{lemma:constraint-sat},
            let us take $[[uσ]]$ such that
            $[[ Θ ⊢ uσ : uv(uM) ∪ uv(uQ) ]]$ and 
            $[[ Θ ⊢ uσ : SC ]]$.
            By the soundness of constraint merge, 
            $[[ Θ ⊢ uσ : SC1 ]]$ and $[[ Θ  ⊢ uσ : SC2 ]]$,
            and by weakening, $[[ Θ' ⊢ uσ : SC1 ]]$ and $[[ Θ' ⊢ uσ : SC2 ]]$.

            Then as noted above (\ref{typing-soundness:SC1-initiality}),
            $[[ Γ ; Φ ⊢ iM ● args ⇒> [uσ]↑uQ ]]$
            And again, by soundness of negative subtyping (\cref{lemma:neg-subtyping-soundness})
            applied to $[[Γ; Θ ⊨ ↑uQ ≤ ↑iP ⫤ SC2]]$,
            we have
            $[[Γ ⊢ [uσ]↑uQ ≤ ↑iP]]$.

            To infer $[[Γ ; Φ ⊢ let x : iP = v(args); c' : iN ]]$,
            we apply the corresponding declarative rule \ruleref{\ottdruleDTAppLetAnnLabel}, where
            $[[iQ]]$ is $[[ [uσ]uQ  ]]$. Notice that all the premises were already shown to
            hold above:
            \begin{enumerate}
                \item $[[Γ ⊢ iP]]$ and $[[Γ; Φ ⊢ v : ↓iM]]$ from the assumption,
                \item $[[Γ; Φ ⊢ iM ● args ⇒> ↑[uσ]uQ]]$ holds since $[[ [uσ]↑uQ ]] = [[ ↑[uσ]uQ ]]$,
                \item $[[Γ ⊢ ↑[uσ]uQ ≤ ↑iP]]$ by soundness of negative subtyping,
                \item $[[Γ; Φ, x:iP ⊢ c' : iN]]$ from the the induction hypothesis.
            \end{enumerate}

        \item \ruleref{\ottdruleATAppLetLabel}
            We are proving that if
            $[[Γ; Φ ⊨ let x = v(args); c' : iN]]$
            then
            $[[Γ ; Φ ⊢ let x = v(args); c' : iN]]$ and
            $[[Γ ⊢ iN]]$.

            By the inversion, we have:
            \begin{enumerate}
                \item $[[Γ; Φ ⊨ v : ↓iM]]$ 
                \item $[[Γ ; Φ ; · ⊨ uM ● args ⇒> ↑uQ ⫤ Θ; SC]]$
                \item $[[uv uQ ⊆ dom(SC)]]$
                \item $[[SC|uv(uQ) singular with uσ3]]$
                \item $[[Γ; Φ, x:[uσ3]uQ ⊨ c' : iN]]$
            \end{enumerate}

            By the induction hypothesis applied to $[[Γ; Φ ⊨ v : ↓iM]]$, we have    
            $[[Γ; Φ ⊢ v : ↓iM]]$ and $[[Γ ⊢ ↓iM]]$ (and thus, $[[Γ ; dom(Θ) ⊢  uM]]$).
       
            By the induction hypothesis applied to $[[Γ; Φ, x:[uσ3]uQ ⊨ c' : iN]]$, we have
            $[[Γ ⊢ iN]]$ and $[[Γ; Φ, x:[uσ3]uQ ⊢ c' : iN]]$.

            By the induction hypothesis applied to 
            $[[Γ ; Φ ; · ⊨ uM ● args ⇒> ↑uQ ⫤ Θ; SC]]$, we have:
            \begin{enumerate}
                \item $[[Γ ⊢ Θ]]$
                \item $[[Γ; dom(Θ) ⊢  ↑uQ]]$
                \item $[[Θ|uv uM ∪ uv uQ ⊢ SC]]$ (and thus, $[[dom(SC) ⊆ uv uM ∪ uv uQ]]$)
                \item for any $[[ Θ ⊢ uσ : SC ]]$, we have $[[ Γ ; Φ ⊢ [uσ]uM ● args ⇒> [uσ]↑uQ ]]$, 
                    which, since  $[[iM]]$ is ground means $[[ Γ ; Φ ⊢ iM ● args ⇒> ↑[uσ]uQ]]$.
            \end{enumerate}


            To infer $[[Γ ; Φ ⊢ let x = v(args) ; c' : iN ]]$, 
            we apply the corresponding 
            declarative rule \ruleref{\ottdruleDTAppLetLabel}.
            Let us show that the premises hold:
            \begin{itemize}
                \item $[[Γ; Φ ⊢ v : ↓iM]]$ holds by the induction hypothesis;
                \item $[[Γ; Φ, x:[uσ3]uQ ⊢ c' : iN]]$ also holds by the induction hypothesis, as noted above;
                \item Let us take an arbitrary substitution $[[uσ]]$ 
                    $[[ Θ ⊢ uσ : uv uM ∪ uv uQ ]]$
                    satisfying $[[ Θ ⊢ uσ : SC ]]$
                    (it exists by \cref{lemma:constraint-sat}).
                    Then $[[Γ; Φ ⊢ iM ● args ⇒> ↑[uσ]uQ ]]$ holds, as noted above;
                \item To show the uniqueness of $[[↑[uσ]uQ]]$,
                    we assume that for some other type $[[iK]]$ 
                    holds $[[Γ; Φ ⊢ iM ● args ⇒> iK ]]$,
                    that is $[[Γ; Φ ⊢ [·]uM ● args ⇒> iK ]]$.
                    Then by the completeness of typing 
                    (\cref{lemma:typing-completeness}),
                    there exist $[[uN']]$, $[[Θ']]$, and $[[SC']]$ such that
                    \begin{enumerate}
                        \item $[[ Γ; Φ; · ⊨ uM ● args ⇒> uN' ⫤ Θ'; SC' ]]$ and
                        \item there exists a substitution $[[Θ' ⊢ uσ' : SC']]$ 
                            such that $[[Γ ⊢ [uσ']uN' ≈ iK]]$.
                    \end{enumerate}
                    By determinicity of the typing algorithm (\cref{lemma:typing-determinicity}),
                    $[[ Γ; Φ; · ⊨ uM ● args ⇒> uN' ⫤ Θ'; SC' ]]$,
                    means that $[[SC']]$ is $[[SC]]$, $[[Θ']]$ is $[[Θ]]$, and $[[uN']]$ is
                    $[[↑uQ]]$. 
                    This way, $[[Γ ⊢ [uσ']↑uQ ≈ iK]]$ for substitution 
                    $[[Θ ⊢ uσ' : SC]]$. 

                    It is left to show that $[[Γ ⊢ [uσ']↑uQ ≈ [uσ]↑uQ]]$, 
                    then by transitivity of equivalence, we will have $[[Γ ⊢ [uσ]↑uQ ≈ iK]]$.
                    Since $[[ Θ   ⊢ uσ : SC|uv(uQ) ]]$ and $(Θ  ⊢ SC|uv(uQ)) ⊢ uσ'$, 
                    and $[[SC|uv(uQ) singular with uσ3]]$, we have 
                    $[[Θ ⊢ uσ ≈ uσ3 : dom(SC) ∩ uv(uQ)]]$
                    and $[[Θ ⊢ uσ' ≈ uσ3 : dom(SC) ∩ uv(uQ)]]$.
                    Then since $[[uv(uQ) ⊆ dom(SC)]]$, we have $[[dom(SC) ∩ uv(uQ) = uv(uQ)]]$.
                    This way, by transitivity and symmetry of the equivalence, 
                    $[[Θ ⊢ uσ ≈ uσ' : uv(uQ)]]$, which implies
                    $[[Γ ⊢ [uσ']↑uQ ≈ [uσ]↑uQ]]$. 
            \end{itemize}

        \item \ruleref{\ottdruleATUnpackLabel}
            We are proving that if 
            $[[Γ; Φ ⊨ let∃ (nas, x) = v; c' : iN]]$
            then
            $[[Γ ; Φ ⊢ let∃ (nas, x) = v; c' : iN]]$ and
            $[[Γ ⊢ iN]]$.
            By the inversion, we have:
            \begin{enumerate}
                \item $[[Γ; Φ ⊨ v : ∃nas.iP]]$
                \item $[[Γ, nas ; Φ, x:iP ⊨ c' : iN]]$
                \item $[[Γ ⊢ iN]]$
            \end{enumerate}

            By the induction hypothesis applied to 
            $[[Γ; Φ ⊨ v : ∃nas.iP]]$, we have $[[Γ; Φ ⊢ v : ∃nas.iP]]$
            and $[[∃nas.iP]]$ is normalized.
            By the induction hypothesis applied to
            $[[Γ, nas ; Φ, x:iP ⊨ c' : iN]]$, we have $[[Γ, nas ; Φ, x:iP ⊢ c' : iN]]$.

            To show $[[Γ; Φ ⊢ let∃ (nas, x) = v; c' : iN]]$, we apply the corresponding
            declarative rule \ruleref{\ottdruleDTUnpackLabel}. Let us show that the premises hold:
            \begin{enumerate}
                \item $[[Γ ; Φ ⊢ v : ∃nas.iP]]$ holds by the induction hypothesis, as noted above,
                \item $[[nf(∃nas.iP) = ∃nas.iP]]$ holds since $[[∃nas.iP]]$ is normalized,
                \item $[[Γ, nas ; Φ, x:iP ⊢ c' : iN]]$ also holds by the induction hypothesis,
                \item $[[Γ ⊢ iN]]$ holds by the inversion, as noted above.
            \end{enumerate}

        \item \ruleref{\ottdruleATEmptyAppLabel}
            Then by assumption:
            \begin{itemize}
                \item $[[Γ ⊢ Θ]]$,
                \item $[[Γ; dom(Θ) ⊢  uN]]$ is free from negative algorithmic variables,
                \item $[[Γ; Φ; Θ ⊨ uN ● · ⇒> nf(uN) ⫤ Θ; ·]]$.
            \end{itemize}

            Let us show the required properties: 
            \begin{enumerate}
                \item $[[Γ ⊢ Θ]]$ holds by assumption,
                \item $[[Θ]] \subseteq [[Θ]]$ holds trivially,
                \item $[[nf(uN)]]$ is evidently normalized, 
                    $[[Γ; dom(Θ) ⊢  uN]]$ implies $[[Γ; dom(Θ) ⊢  nf(uN)]]$ by 
                    \cref{corollary:wf-nf-algo},
                    and \cref{lemma:fv-nf} means that $[[nf(uN)]]$ is 
                    inherently free from negative algorithmic variables,
                \item $[[dom(Θ) ∩ uv(nf(uN)) ⊆ uv uN]]$
                    holds since $[[uv(nf(uN)) = uv(uN)]]$,
                \item $[[Θ|uv uN ∪ uv nf(uN) ⊢ ·]]$ holds trivially,
                \item suppose that $[[ Θ ⊢ uσ : uv uN ∪ uv nf(uN) ]]$.
                    To show $[[ Γ ; Φ ⊢ [uσ]uN ● · ⇒> [uσ]nf(uN) ]]$, we apply the corresponding 
                    declarative rule \ruleref{\ottdruleDTEmptyAppLabel}.
                    To show $[[ Γ ⊢ [uσ]uN ≈ [uσ]nf(uN) ]]$,
                    we apply the following sequence:
                    $[[uN ≈ nf(uN)]]$ by 
                    \cref{lemma:normalization-soundness},
                    then $[[ [uσ]uN ≈ [uσ]nf(uN) ]]$
                    by \cref{corollary:subst-pres-equiv},
                    then $[[ Γ ⊢ [uσ]uN ≈ [uσ]nf(uN) ]]$
                    by \cref{lemma:equiv-soundness}. 
            \end{enumerate}

        \item \ruleref{\ottdruleATArrowAppLabel} 
            By assumption:
            \begin{enumerate}
                \item $[[Γ ⊢ Θ]]$,
                \item $[[Γ; dom(Θ) ⊢ uQ → uN]]$ is free from negative algorithmic variables,
                    and hence, so are $[[uQ]]$ and $[[uN]]$,
                \item $[[Γ; Φ; Θ ⊨ uQ → uN ● v , args ⇒> uM ⫤ Θ'; SC]]$, 
                    and by inversion: 
                    \begin{enumerate}
                        \item $[[Γ; Φ ⊨ v : iP]]$,
                            and by the induction hypothesis applied to this judgment,
                            we have $[[Γ; Φ ⊢ v : iP]]$, and $[[Γ ⊢ iP]]$;
                        \item $[[Γ; Θ ⊨ uQ ≥ iP ⫤ SC1]]$,
                            and by the soundness of subtyping:
                            $[[Θ ⊢ SC1 : uv uQ]]$ 
                            (and thus, $[[dom(SC1) = uv uQ]]$),
                            and
                            for any
                            
                            $[[ Θ ⊢ uσ : SC1 ]]$, we have $[[Γ ⊢ [uσ]uQ ≥ iP]]$;
                        \item $[[Γ; Φ; Θ ⊨ uN ● args ⇒> uM ⫤ Θ'; SC2]]$,
                            and by the induction hypothesis applied to this judgment,
                            \begin{enumerate}
                                \item $[[Γ ⊢ Θ']]$,
                                \item $[[Θ ⊆ Θ']]$,
                                \item $[[Γ; dom(Θ') ⊢  uM]]$ is normalized and free from negative algorithmic variables,
                                \item $[[dom(Θ) ∩ uv(uM) ⊆ uv uN]]$,
                                \item $[[Θ'|uv(uM) ∪ uv(uN) ⊢ SC2]]$, and thus, $[[dom(SC2) ⊆ uv(uM) ∪ uv(uN)]]$,
                                \item for any $[[uσ]]$ such that
                                    $[[Θ ⊢ uσ : uv(uM) ∪ uv(uN) ]]$
                                    and 
                                    $[[ Θ' ⊢ uσ : SC2 ]]$, we have 
                                    $[[ Γ ; Φ ⊢ [uσ]uN ● args ⇒> [uσ]uM ]]$;
                            \end{enumerate}
                        \item $[[Θ ⊢ SC1 & SC2 = SC]]$,
                            which by \cref{lemma:merge-soundness} implies
                            $[[dom(SC) = dom(SC1) ∪ dom(SC2)]] \subseteq [[uv uQ ∪ uv uM ∪ uv uN]]$.
                    \end{enumerate}
            \end{enumerate}

            Let us show the required properties:
            \begin{enumerate}
                \item $[[Γ ⊢ Θ']]$ is shown above,
                \item $[[Θ ⊆ Θ']]$ is shown above,
                \item $[[Γ; dom(Θ') ⊢  uM]]$ is normalized and free from negative algorithmic variables, as shown above,
                \item $[[dom(Θ) ∩ uv(uM) ⊆ uv uN ⊆ uv(uQ → uN)]]$
                    (the first inclusion is shown above, the second one is by definition),
                \item To show $[[Θ'|uv(uQ) ∪ uv(uN) ∪ uv(uM) ⊢ SC]]$,
                    first let us notice that $[[uv(uQ) ∪ uv(uN) ∪ uv(uM) ⊆ dom(SC)]]$,
                    as mentioned above.
                    Then we demonstrate 
                    $[[Θ' ⊢ SC]]$:
                    $[[Θ ⊢ SC1]]$ and $[[Θ ⊆ Θ']]$ imply $[[Θ' ⊢ SC1]]$,
                    by the soundness of constraint merge (\cref{lemma:merge-soundness})
                    applied to $[[Θ' ⊢ SC1 & SC2 = SC]]$:
                    \begin{enumerate}
                        \item $[[Θ' ⊢ SC]]$,
                        \item for any $[[ Θ' ⊢ uσ : SC ]]$, $[[ Θ' ⊢ uσ : SCi ]]$ holds;
                    \end{enumerate}
                \item Suppose that 
                    $[[ Θ' ⊢ uσ : uv(uQ) ∪ uv(uN) ∪ uv(uM) ]]$
                    and $[[ Θ' ⊢ uσ : SC ]]$.
                    To show $[[ Γ ; Φ ⊢ [uσ](uQ → uN) ● v , args ⇒> [uσ]uM ]]$, 
                    that is $[[ Γ ; Φ ⊢ [uσ]uQ → [uσ]uN ● v , args ⇒> [uσ]uM ]]$,
                    we apply the corresponding declarative rule \ruleref{\ottdruleDTArrowAppLabel}.
                    Let us show the required premises:
                    \begin{enumerate}
                        \item $[[Γ; Φ ⊢ v : iP]]$ holds as shown above,
                        \item $[[Γ ⊢ [uσ]uQ ≥ iP]]$ holds 
                            since $[[Γ ⊢ [uσ|uv(uQ)]uQ ≥ iP]]$ by the soundness of subtyping 
                            as noted above:
                            since $[[ Θ' ⊢ uσ : SC ]]$ implies $[[ Θ' ⊢ uσ|uv(uQ) : SC1 ]]$,
                            which we strengthen to $[[ Θ ⊢ uσ|uv(uQ) : SC1 ]]$,
                        \item $[[Γ; Φ ⊢ [uσ]uN ● args ⇒> [uσ]uM]]$ holds by the induction hypothesis
                            as shown above,
                            since $[[ Θ' ⊢ uσ : SC ]]$ implies $[[ Θ' ⊢ uσ : SC2 ]]$,
                            and then $[[ Θ' ⊢ uσ | uv(uN) ∪ uv(uM) : SC2 ]]$
                            and $[[ Θ ⊢ uσ | uv(uN) ∪ uv(uM) : uv(uN) ∪ uv(uM) ]]$.
                    \end{enumerate}
            \end{enumerate}

        \item \ruleref{\ottdruleATForallAppLabel}\\
            By assumption:
            \begin{enumerate}
                \item $[[Γ ⊢ Θ]]$,
                \item $[[Γ; dom(Θ) ⊢  ∀pas.uN]]$ is free from negative algorithmic variables,
                \item $[[Γ; Φ; Θ ⊨ ∀pas.uN ● args ⇒> uM ⫤ Θ'; SC]]$, which by inversion means
                    $[[args ≠ ·]]$, $[[pas ≠ ·]]$, and $[[Γ; Φ; Θ, â⁺*[Γ] ⊨ [â⁺*/pas]uN ● args ⇒> uM ⫤ Θ'; SC]]$.
                    It is easy to see that the induction hypothesis is applicable to the latter judgment:
                    \begin{itemize}
                        \item $[[Γ ⊢ Θ, â⁺*[Γ] ]]$ holds by $[[Γ ⊢ Θ]]$, 
                        \item $[[Γ; dom(Θ), â⁺* ⊢ [â⁺*/pas]uN]]$
                            holds since $[[Γ; dom(Θ) ⊢ ∀pas.uN]]$
                            $[[ [â⁺*/pas]uN ]]$ is normalized and free from negative algorithmic variables
                            since so is $[[uN]]$;
                    \end{itemize}
                    This way, by the inductive hypothesis applied to 
                    $[[Γ; Φ; Θ, â⁺*[Γ] ⊨ [â⁺*/pas]uN ● args ⇒> uM ⫤ Θ'; SC]]$,
                    we have:
                    \begin{enumerate}
                        \item $[[Γ ⊢ Θ']]$,
                        \item $[[Θ, â⁺*[Γ] ⊆ Θ']]$,
                        \item $[[Γ; dom(Θ') ⊢ uM]]$ is normalized and free from negative algorithmic variables,
                        \item $[[dom(Θ, â⁺*[Γ]) ∩ uv(uM) ⊆ uv([â⁺*/pas]uN)]]$,
                        \item $[[Θ'|Ξ ∪ uv(uN) ∪ uv(uM) ⊢ SC]]$, where $[[Ξ]]$ denotes $[[uv([â⁺*/pas]uN) ∩ {â⁺*}]]$,
                            that is the algorithmization of the $[[∀]]$-variables that are actually used in $[[uN]]$.
                        \item  \label{typing-soundness:forall-ih}
                            for any 
                            $[[uσ]]$ such that 
                            $[[Θ' ⊢ uσ : Ξ ∪ uv(uN) ∪ uv(uM)]]$ and $[[ Θ' ⊢ uσ : SC ]]$, 
                            we have $[[ Γ ; Φ ⊢ [uσ][â⁺*/pas]uN ● args ⇒> [uσ]uM ]]$.
                    \end{enumerate}
            \end{enumerate}

            Let us show the required properties:
            \begin{enumerate}
                \item $[[Γ ⊢ Θ']]$ is shown above;
                \item $[[Θ ⊆ Θ']]$ since $[[Θ, â⁺*[Γ] ⊆ Θ']]$;
                \item $[[Γ; dom(Θ') ⊢  uM]]$ is normalized and free from negative algorithmic variables, as shown above;
                \item $[[dom(Θ) ∩ uv(uM) ⊆ uv(uN)]]$
                    since 
                    $[[dom(Θ, â⁺*[Γ]) ∩ uv(uM) ⊆ uv([â⁺*/pas]uN)]]$
                    implies 
                    $[[(dom(Θ) ∪ {â⁺*}) ∩ uv(uM) ⊆ uv(uN) ∪ {â⁺*}]]$,
                    thus,
                    $[[dom(Θ) ∩ uv(uM) ⊆ uv(uN) ∪ {â⁺*}]]$,
                    and since $[[dom(Θ)]]$ is disjoint with $[[{â⁺*}]]$,
                    $[[dom(Θ) ∩ uv(uM) ⊆ uv(uN)]]$;

                \item $[[Θ'|uv(uN) ∪ uv(uM) ⊢ SC | uv(uN) ∪ uv(uM)]]$ follows from 
                    $[[Θ'|Ξ ∪ uv(uN) ∪ uv(uM) ⊢ SC]]$ if we restrict both sides to 
                    $[[uv(uN) ∪ uv(uM)]]$.
                \item Let us assume $[[ Θ' ⊢ uσ : uv(uN) ∪ uv(uM) ]]$ and
                    $[[ Θ' ⊢ uσ : SC | uv(uN) ∪ uv(uM) ]]$.
                    Then to show $[[ Γ ; Φ ⊢ [uσ]∀pas.uN ● args ⇒> [uσ]uM ]]$,
                    that is $[[ Γ ; Φ ⊢ ∀pas.[uσ]uN ● args ⇒> [uσ]uM ]]$,
                    we apply the corresponding declarative rule \ruleref{\ottdruleDTForallAppLabel}.
                    To do so, we need to provide a substitution for $[[pas]]$, 
                    i.e. $[[Γ ⊢ σ0 : {pas}]]$ such that
                    $[[Γ; Φ ⊢ [σ0][uσ]uN ● args ⇒> [uσ]uM ]]$.

                    By \cref{lemma:constraint-sat},
                    we construct $[[uσ0]]$ such that
                    $[[Θ' ⊢ uσ0 : {â⁺*}]]$
                    and 
                    $[[Θ' ⊢ uσ0 : SC|{â⁺*}]]$.

                    Then $[[σ0]]$ is defined as 
                    $[[uσ0]] \circ [[uσ|{â⁺*}]] \circ [[â⁺*/pas]]$. 

                    Let us show that the premises of 
                    \ruleref{\ottdruleDTForallAppLabel} hold:
                    \begin{itemize}
                        \item To show $[[Γ ⊢ σ0 :{pas}]]$,
                            let us take $[[αi⁺ ∊ {pas}]]$.
                            If $[[ αî⁺ ∊ uv(uM)]]$
                            then $[[ [σ0]αi⁺ = [uσ]αî⁺ ]]$,
                            and $[[ Θ' ⊢ uσ : uv(uN) ∪ uv(uM) ]]$
                            implies $[[Θ'(α̂⁺) ⊢ [uσ]α̂⁺]]$.
                            Analogously, if $[[ αî⁺ ∊ {â⁺*} \ uv(uM)]]$
                            then $[[ [σ0]αi⁺ = [uσ0]αî⁺ ]]$,
                            and $[[Θ' ⊢ uσ0 : {â⁺*}]]$ implies $[[Θ'(αî⁺) ⊢ [uσ0]αî⁺]]$.
                            In any case, $[[Θ'(αî⁺) ⊢ [σ]αi⁺ ]]$
                            can be weakened to $[[Γ ⊢ [σ0]αi⁺]]$, 
                            since $[[Γ ⊢ Θ']]$.

                        \item Let us show $[[Γ; Φ ⊢ [σ0][uσ]uN ● args ⇒> [uσ]uM ]]$.
                            It suffices to construct $[[uσ1]]$ such that
                            \begin{enumerate}
                                \item $[[Θ' ⊢ uσ1 : Ξ ∪ uv(uN) ∪ uv(uM)]]$,
                                \item $[[Θ' ⊢ uσ1 : SC]]$,
                                \item $[[ [σ0][uσ]uN = [uσ1][â⁺*/pas]uN]]$, and
                                \item $[[ [uσ]uM = [uσ1]uM]]$,
                            \end{enumerate}
                            because then we can apply the induction hypothesis
                            (\ref{typing-soundness:forall-ih}) to
                            $[[uσ1]]$, rewrite the conclusion by 
                            $[[ [uσ1][â⁺*/pas]uN = [σ0][uσ]uN]]$ and
                            $[[ [uσ1]uM = [uσ]uM]]$, and infer the required judgement.

                            Let us take $[[uσ1]] = [[(uσ0 ○ uσ)|Ξ ∪ uv(uN) ∪ uv(uM)]]$, then 
                            \begin{enumerate}
                                \item $[[Θ' ⊢ uσ1 : Ξ ∪ uv(uN) ∪ uv(uM)]]$,
                                    since $[[Θ' ⊢ uσ0 : {â⁺*}]]$ and 
                                    $[[ Θ' ⊢ uσ : uv(uN) ∪ uv(uM) ]]$, 
                                    we have 
                                    $[[Θ' ⊢ uσ0 ○ uσ : {â⁺*} ∪ uv(uN) ∪ uv(uM)]]$, 
                                    which we restrict to $[[Ξ ∪ uv(uN) ∪ uv(uM)]]$.
                                \item $[[Θ' ⊢ uσ1 : SC]]$,
                                    Let us take any constraint $[[scE ∊ SC]]$ restricting 
                                    variable $[[β̂±]]$.
                                    $[[Θ'|Ξ ∪ uv(uN) ∪ uv(uM) ⊢ SC]]$
                                    implies that $[[β̂± ∊ Ξ ∪ uv(uN) ∪ uv(uM)]]$.

                                    If $[[β̂± ∊ uv(uN) ∪ uv(uM)]]$ then 
                                    $[[ [uσ1]β̂± = [uσ]β̂± ]]$.
                                    Additionally, $[[scE ∊ SC | uv(uN) ∪ uv(uM)]]$,
                                    which, since $[[ Θ' ⊢ uσ : SC | uv(uN) ∪ uv(uM) ]]$,
                                    means $[[Θ'(β̂±) ⊢ [uσ]β̂± : scE]]$.

                                    If $[[β̂± ∊ Ξ \ (uv(uN) ∪ uv(uM))]]$ then
                                    $[[ [uσ1]β̂± = [uσ0]β̂± ]]$.
                                    Additionally, $[[scE ∊ SC | {â⁺*}]]$,
                                    which, since $[[ Θ' ⊢ uσ0 : SC | {â⁺*} ]]$,
                                    means $[[Θ'(β̂±) ⊢ [uσ0]β̂± : scE]]$.

                                \item Let us prove $[[ [σ0][uσ]uN = [uσ1][â⁺*/pas]uN]]$
                                    by the following reasoning
                                    $$ 
                                    \begin{aligned}[t] 
                                        [[ [σ0][uσ]uN  ]] 
                                            &= [[ [uσ0][uσ|{â⁺*}][â⁺*/pas][uσ]uN ]] 
                                                && \text{by definition of $[[σ0]]$}\\
                                            &= [[ [uσ0][uσ|{â⁺*}][â⁺*/pas][uσ|uv(uN)]uN ]]
                                                && \text{by \cref{lemma:subst-restr-uv}}\\
                                            &= [[ [uσ0][uσ|{â⁺*}][uσ|uv(uN)][â⁺*/pas]uN ]]
                                                && \text{$[[uv(uN) ∩ {â⁺*} = ∅]]$ and 
                                                    $[[{pas} ∩ Γ = ∅]]$}\\
                                            &= [[ [uσ|{â⁺*}][uσ|uv(uN)][â⁺*/pas]uN ]] 
                                                && \text{$[[ [uσ|{â⁺*}][uσ|uv(uN)][â⁺*/pas]uN ]]$
                                                is ground}\\
                                            &= [[ [uσ|{â⁺*} ∪ uv(uN)][â⁺*/pas]uN ]] \\
                                            &= [[ [uσ|Ξ ∪ uv(uN)][â⁺*/pas]uN ]] 
                                                && \text{by \cref{lemma:subst-restr-uv}:
                                                    $[[ uv([â⁺*/pas]uN) = Ξ ∪ uv(uN)]]$}\\
                                            &= [[ [uσ|Ξ ∪ uv(uN) ∪ uv(uM)][â⁺*/pas]uN ]] 
                                                && \text{also by \cref{lemma:subst-restr-uv}}\\
                                            &= [[ [(uσ0 ○ uσ)|Ξ ∪ uv(uN) ∪ uv(uM)][â⁺*/pas]uN ]]
                                                && \text{$[[ [uσ|Ξ ∪ uv(uN) ∪ uv(uM)][â⁺*/pas]uN]]$ is ground}\\
                                            &= [[ [uσ1][â⁺*/pas]uN ]]
                                                && \text{by definition of $[[uσ1]]$}\\
                                        \end{aligned} 
                                    $$
                                \item $[[ [uσ]uM = [uσ1]uM]]$
                                        By definition of $[[uσ1]]$,
                                        $[[ [uσ1]uM ]]$ is equal to 
                                        $[[ [(uσ0 ○ uσ)|Ξ ∪ uv(uN) ∪ uv(uM)]uM ]]$,
                                        which by \cref{lemma:subst-restr-uv} is equal to
                                        $[[ [uσ0 ○ uσ]uM ]]$,
                                        that is $[[ [uσ0][uσ]uM ]]$,
                                        and since $[[ [uσ]uM ]]$ is ground, 
                                        $[[ [uσ0][uσ]uM = [uσ]uM ]]$.
                            \end{enumerate}
                        \item $[[pas ≠ ·]]$ and $[[args ≠ ·]]$ hold by assumption.
                    \end{itemize}
            \end{enumerate}
    \end{caseof}
\end{proof}


\begin{lemma}[Completeness of Typing]
    \label{lemma:typing-completeness}
    Suppose that $[[Γ ⊢ Φ]]$.
    For an inference tree $T_1$,
    \begin{itemize}
        \item [$+$] If $T_1$ infers $[[Γ; Φ ⊢ v : iP]]$ then $[[Γ; Φ ⊨ v : nf(iP)]]$        
        \item [$-$] If $T_1$ infers $[[Γ; Φ ⊢ c : iN]]$ then  $[[Γ; Φ ⊨ c : nf(iN)]]$
        \item [$\bullet$] If 
            $T_1$ infers $[[Γ; Φ ⊢ [uσ]uN ● args ⇒> iM]]$
            and 
            \begin{enumerate}
                \item $[[Γ ⊢ Θ]]$, 
                \item $[[Γ ⊢ iM]]$,
                \item $[[Γ; dom(Θ) ⊢ uN]]$ (free from negative algorithmic variables, that is $[[α̂⁻]] \notin [[uv uN]]$), and
                \item $[[Θ ⊢ uσ : uv(uN)]]$,
            \end{enumerate}
            then there exist $[[uM']]$, $[[Θ']]$, and $[[SC]]$ such that
            \begin{enumerate}
                \item $[[ Γ; Φ; Θ ⊨ uN ● args ⇒> uM' ⫤ Θ'; SC ]]$ and
                \item for any $[[Θ ⊢ uσ : uv(uN)]]$ and $[[Γ ⊢ iM]]$
                    such that $[[Γ; Φ ⊢ [uσ]uN ● args ⇒> iM]]$, 
                    there exists $[[uσ']]$ such that 
                    \begin{enumerate}
                        \item $[[Θ' ⊢ uσ' : uv uN ∪ uv uM]]$
                            and $[[Θ' ⊢ uσ' : SC]]$,
                        \item $[[Θ ⊢ uσ' ≈ uσ : uv uN]]$, and 
                        \item $[[Γ ⊢ [uσ']uM' ≈ iM]]$.
                    \end{enumerate}
            \end{enumerate}
    \end{itemize}
\end{lemma}
\begin{proof}
    We prove it by induction on $\metric{T_1}$, mutually with 
    the soundness of typing (\cref{lemma:typing-soundness}).
    Let us consider the last rule applied to infer the derivation.
    \begin{caseof}

        \item \ruleref{\ottdruleDTThunkLabel}\\
            \label{case:typing-completeness-thunk}
            Then we are proving that if 
            $[[Γ; Φ ⊢ {c} : ↓iN]]$ (inferred by \ruleref{\ottdruleDTThunkLabel})
            then $[[Γ; Φ ⊨ {c} : nf(↓iN)]]$.
            By inversion of $[[Γ; Φ ⊢ {c} : ↓iN]]$, we have
            $[[Γ; Φ ⊢ c : iN]]$, which we apply the induction hypothesis to
            to obtain $[[Γ; Φ ⊨ c : nf(iN)]]$.
            Then by \ruleref{\ottdruleATThunkLabel}, we have $[[Γ; Φ ⊨ {c} : ↓nf(iN)]]$.
            It is left to notice that $[[↓nf(iN) = nf(↓iN)]]$.

        \item \ruleref{\ottdruleDTReturnLabel}\\
            The proof is symmetric to the previous case 
            (\cref{case:typing-completeness-thunk}).

        \item \ruleref{\ottdruleDTPAnnotLabel}\\
            \label{case:typing-completeness-pannot}
            Then we are proving that if
            $[[Γ; Φ ⊢ (v : iQ) : iQ]]$ is inferred by \ruleref{\ottdruleDTPAnnotLabel}
            then $[[Γ; Φ ⊨ (v : iQ) : nf(iQ)]]$.
            By inversion, we have:
            \begin{enumerate}
                \item $[[Γ ⊢ iQ]]$;
                \item $[[Γ; Φ ⊢ v : iP]]$, which
                    by the induction hypothesis implies $[[Γ; Φ ⊨ v : nf(iP)]]$;
                \item $[[Γ ⊢ iQ ≥ iP]]$, and by transitivity, $[[Γ ⊢ iQ ≥ nf(iP)]]$;
                    Since $[[iQ]]$ is ground, 
                    we have $[[Γ ; · ⊢ uQ]]$ and $[[Γ ⊢ [·]uQ ≥ nf(iP)]]$.
                    Then by the completeness of subtyping
                    (\cref{lemma:subtyping-completeness}), we have 
                    $[[Γ ; · ⊨ uQ ≥ nf(iP) ⫤ SC]]$, where $[[· ⊢ SC]]$ 
                    (implying $[[SC]] = [[·]]$).
                    This way, $[[Γ ; · ⊨ uQ ≥ nf(iP) ⫤ ·]]$.
            \end{enumerate}
            Then we can apply \ruleref{\ottdruleATPAnnotLabel} to
            $[[Γ ⊢ iQ]]$, $[[Γ; Φ ⊨ v : nf(iP)]]$ and $[[Γ ; · ⊨ uQ ≥ nf(iP) ⫤ ·]]$
            to infer $[[Γ; Φ ⊨ (v : iQ) : nf(iQ)]]$.

        \item \ruleref{\ottdruleDTNAnnotLabel}\\
            The proof is symmetric to the previous case 
            (\cref{case:typing-completeness-pannot}).

        \item \ruleref{\ottdruleDTtLamLabel}\\
            Then we are proving that if
            $[[Γ ; Φ ⊢ λx:iP . c : iP → iN]]$ is inferred by \ruleref{\ottdruleDTtLamLabel},
            then $[[Γ ; Φ ⊨ λx:iP . c : nf(iP → iN)]]$.

            By inversion of $[[Γ ; Φ ⊢ λx:iP . c : iP → iN]]$, we have
            $[[Γ ⊢ iP]]$ and $[[Γ; Φ, x:iP ⊢ c : iN]]$.
            Then by the induction hypothesis, $[[Γ; Φ, x:iP ⊨ c : nf(iN)]]$.
            By \ruleref{\ottdruleATtLamLabel}, we infer
            $[[Γ; Φ ⊨ λx:iP . c : nf(iP → nf(iN))]]$. 
            By idempotence of normalization (\cref{lemma:norm-idemp}), 
            $[[nf(iP → nf(iN)) = nf(iP → iN)]]$, 
            which concludes the proof for this case.

        \item \ruleref{\ottdruleDTTLamLabel}\\
            Then we are proving that if
            $[[Γ ; Φ ⊢ Λα⁺ . c : ∀α⁺.iN]]$ is inferred by \ruleref{\ottdruleDTTLamLabel},
            then $[[Γ ; Φ ⊨ Λα⁺ . c : nf(∀α⁺.iN)]]$.
            Similar to the previous case, 
            by inversion of $[[Γ ; Φ ⊢ Λα⁺ . c : ∀α⁺.iN]]$, we have
            $[[Γ, α⁺ ; Φ ⊢ c : iN]]$, and then by the induction hypothesis,
            $[[Γ, α⁺ ; Φ ⊨ c : nf(iN)]]$.
            After that, application of \ruleref{\ottdruleATTLamLabel}, 
            gives as $[[Γ ; Φ ⊨ Λα⁺ . c : nf(∀α⁺.nf(iN))]]$.

            It is left to show that $[[nf(∀α⁺.nf(iN)) = nf(∀α⁺.iN)]]$.
            Assume $[[iN = ∀pbs.iM]]$ (where $[[iM]]$ does not start with $\forall$).
            \begin{itemize}
                \item Then by definition, $[[nf(∀α⁺.iN) = nf(∀α⁺,pbs.iM)]] = 
                    [[∀pcs.nf(iM)]]$, where $[[ord {α⁺,pbs} in nf(iM) = pcs]]$.
                \item On the other hand, $[[nf(iN) = ∀pcs'.nf(iM)]]$, 
                    where $[[ord {pbs} in nf(iM) = pcs']]$, and thus, 
                    $[[nf(∀α⁺.nf(iN)) = nf(∀α⁺,pcs'.nf(iM))]] = [[∀pcs''.nf(nf(iM))]]
                    = [[∀pcs''.nf(iM)]]$,
                    where $[[ord {α⁺,pcs'} in nf(nf(iM)) = pcs'']]$. 
            \end{itemize}
            It is left to show that $[[pcs'' = pcs]]$.
            $$ 
            \begin{aligned}[t] 
                [[ pcs'' ]] &= [[ord {α⁺,pcs'} in nf(nf(iM))]] \\
                            &= [[ord {α⁺,pcs'} in nf(iM)]]
                            && \text{by idempotence (\cref{lemma:norm-idemp})}\\
                            &= [[ord {α⁺} ∪ {pbs} ∩ fv nf(iM) in nf(iM)]]
                            && \text{by definition of $[[pcs']]$ and \cref{lemma:ord-soundness}}\\
                            &= [[ord ({α⁺} ∪ {pbs} ∩ fv nf(iM)) ∩ fv nf(iM) in nf(iM)]]
                            && \text{by \cref{corollary:ord-weakening}}\\
                            &= [[ord ({α⁺} ∪ {pbs}) ∩ fv nf(iM) in nf(iM)]]
                            && \text{by set properties}\\
                            &= [[ord {α⁺,pbs} in nf(iM)]]\\
                            &= [[pcs]]
                \end{aligned} 
            $$

        \item \ruleref{\ottdruleDTUnpackLabel}\\
            Then we are proving that if
            $[[Γ ; Φ ⊢ let∃ (nas, x) = v; c : iN]]$ is 
            inferred by \ruleref{\ottdruleDTUnpackLabel},
            then $[[Γ ; Φ ⊨ let∃ (nas, x) = v; c : nf(iN)]]$.

            By inversion of $[[Γ ; Φ ⊢ let∃ (nas, x) = v; c : iN]]$, we have
            \begin{enumerate}
                \item $[[nf(∃nas.iP) = ∃nas.iP]]$,
                \item $[[Γ ; Φ ⊢ v : ∃nas.iP]]$, 
                    which by the induction hypothesis implies 
                    $[[Γ ; Φ ⊨ v : nf(∃nas.iP)]]$, 
                    and hence, $[[Γ ; Φ ⊨ v : ∃nas.iP]]$.
                \item $[[Γ, nas ; Φ, x:iP ⊢ c : iN]]$,
                    and by the induction hypothesis, 
                    $[[Γ, nas ; Φ, x:iP ⊨ c : nf(iN)]]$.
                \item $[[Γ ⊢ iN]]$.
            \end{enumerate}
            
            This way, we can apply \ruleref{\ottdruleATUnpackLabel} to
            infer $[[Γ ; Φ ⊨ let∃ (nas, x) = v; c : nf(iN)]]$.

        \item \ruleref{\ottdruleDTPEquivLabel}\\
            Then we are proving that
            if $[[Γ; Φ ⊢ v : iP']]$ is inferred by \ruleref{\ottdruleDTPEquivLabel},
            then $[[Γ; Φ ⊨ v : nf(iP')]]$.
            By inversion, $[[Γ ; Φ ⊢ v : iP]]$ and $[[Γ ⊢ iP ≈ iP']]$,
            and the metric of the tree inferring $[[Γ ; Φ ⊢ v : iP]]$ is less than the one 
            inferring $[[Γ; Φ ⊢ v : iP']]$.
            Then by the induction hypothesis, $[[Γ; Φ ⊨ v : nf(iP)]]$.

            By \cref{lemma:subt-equiv-algorithmization}
            $[[Γ ⊢ iP ≈ iP']]$ implies $[[nf(iP) = nf(iP')]]$, and thus, 
            $[[Γ; Φ ⊨ v : nf(iP)]]$ can be rewritten to $[[Γ; Φ ⊨ v : nf(iP')]]$.

        \item \ruleref{\ottdruleDTVarLabel}\\
            Then we are proving that
            $[[Γ; Φ ⊢ x : iP]]$
            implies
            $[[Γ; Φ ⊨ x : nf(iP)]]$.
            By inversion of $[[Γ; Φ ⊢ x : iP]]$,
            we have $[[x : iP ∊ Φ ]]$.
            Then \ruleref{\ottdruleATVarLabel} applies to infer
            $[[Γ; Φ ⊨ x : nf(iP)]]$.

        \item \ruleref{\ottdruleDTVarLetLabel}\\
            Then we are proving that
            $[[Γ; Φ ⊢ let x = v(args); c : iN]]$
            implies
            $[[Γ; Φ ⊨ let x = v(args); c : nf(iN)]]$.

            By inversion of
            $[[Γ; Φ ⊢ let x = v(args); c : iN]]$,
            we have
            \begin{enumerate}
                \item $[[Γ; Φ ⊢ v : iP]]$, 
                    and by the induction hypothesis,
                    $[[Γ; Φ ⊨ v : nf(iP)]]$.
                \item $[[Γ; Φ, x:iP ⊢ c : iN]]$,
                    and by \cref{lemma:decl-typing-context-equiv},
                    since $[[Γ ⊢ iP ≈ nf(iP)]]$, we have
                    $[[Γ; Φ, x:nf(iP) ⊢ c : iN]]$.
                    Then by the induction hypothesis, 
                    $[[Γ; Φ, x:nf(iP) ⊨ c : nf(iN)]]$.
            \end{enumerate}

            Together, $[[Γ; Φ ⊨ v : nf(iP)]]$ and $[[Γ; Φ, x:nf(iP) ⊨ c : nf(iN)]]$
            imply $[[Γ; Φ ⊨ let x = v(args); c : nf(iN)]]$ by \ruleref{\ottdruleATVarLetLabel}.

        \item \ruleref{\ottdruleDTAppLetAnnLabel}\\
            Then we are proving that 
            $[[Γ ; Φ ⊢ let x:iP = v(args); c : iN]]$
            implies 
            $[[Γ; Φ ⊨ let x:iP = v(args); c : nf(iN)]]$.

            By inversion of 
            $[[Γ ; Φ ⊢ let x:iP = v(args); c : iN]]$,
            we have
            \begin{enumerate}
                \item $[[Γ ⊢ iP]]$
                \item $[[Γ ; Φ ⊢ v : ↓iM]]$ for some ground $[[iM]]$,
                    which by the induction hypothesis means
                    $[[Γ ; Φ ⊨ v : ↓nf(iM)]]$
                \item $[[Γ ; Φ ⊢ iM ● args ⇒> ↑iQ]]$. 
                    By \cref{lemma:app-inf-equ-stable}, since
                    $[[Γ ⊢ iM ≈ nf(iM)]]$, we have
                    $[[Γ ; Φ ⊢ [·]nf(uM) ● args ⇒> ↑iQ]]$, 
                    which by the induction hypothesis means 
                    that there exist normalized 
                    $[[uM']]$, $[[Θ]]$, and $[[SC1]]$ such that
                    (noting that $[[iM]]$ is ground):
                    \begin{enumerate}
                        \item $[[ Γ; Φ; · ⊨ nf(uM) ● args ⇒> uM' ⫤ Θ; SC1 ]]$,
                            where by the soundness, $[[Γ; dom(Θ) ⊢ uM']]$ and $[[Θ ⊢ SC1]]$.
                        \item for any $[[Γ ⊢ iM'']]$ 
                            such that $[[Γ; Φ ⊢ nf(iM) ● args ⇒> iM'']]$
                            there exists $[[uσ]]$ such that 
                            \begin{enumerate}
                                \item $[[ Θ ⊢ uσ : uv uM' ]]$, $[[ Θ ⊢ uσ : SC1 ]]$, and 
                                \item $[[Γ ⊢ [uσ]uM' ≈ iM'']]$,
                            \end{enumerate}
                            In particular, there exists
                            $[[uσ0]]$
                            such that 
                            $[[ Θ ⊢ uσ0 : uv uM']]$,
                            $[[ Θ ⊢ uσ0 : SC1]]$,
                            $[[Γ ⊢ [uσ0]uM' ≈ ↑iQ]]$.
                            Since $uM'$ is normalized and free of negative algorithmic variables,
                            the latter equivalence means
                            $[[uM' = ↑uQ0]]$ for some $[[uQ0]]$, and $[[Γ ⊢ [uσ0]uQ0 ≈ iQ]]$.
                    \end{enumerate}
                \item $[[Γ ⊢ ↑iQ ≤ ↑iP]]$,
                    and by transitivity, since $[[Γ ⊢ [uσ0]↑uQ0 ≈ ↑iQ]]$,
                    we have $[[Γ ⊢ [uσ0]↑uQ0 ≤ ↑iP]]$.
                    
                    Let us apply \cref{lemma:neg-subt-completeness} to 
                    $[[Γ ⊢ [uσ0]↑uQ0  ≤ ↑iP]]$ and obtain
                    $[[Θ ⊢ SC2]]$ such that 
                    \begin{enumerate}
                        \item $[[Γ ; Θ ⊨ ↑uQ0 ≤ ↑iP ⫤ SC2]]$ and
                        \item $[[ Θ   ⊢ uσ0 : SC2 ]]$.
                    \end{enumerate}
                \item $[[Γ; Φ, x:iP ⊢ c : iN]]$, 
                    and by the induction hypothesis,
                    $[[Γ; Φ, x:iP ⊨ c : nf(iN)]]$.
            \end{enumerate}

            To infer $[[Γ; Φ ⊨ let x:iP = v(args); c : nf(iN)]]$,
            we apply the corresponding algorithmic rule 
            \ruleref{\ottdruleATAppLetAnnLabel}.
            Let us show that the premises hold:
            \begin{enumerate}
                \item $[[Γ ⊢ iP]]$,
                \item $[[Γ; Φ ⊨ v : ↓nf(iM)]]$,
                \item $[[Γ; Φ; · ⊨ nf(uM) ● args ⇒> ↑uQ0 ⫤ Θ; SC1]]$, 
                \item $[[Γ; Θ ⊨ ↑uQ0 ≤ ↑iP ⫤ SC2]]$, and
                \item $[[Γ; Φ, x:iP ⊨ c : nf(iN)]]$ hold as noted above;
                \item $[[Θ ⊢ SC1 & SC2 = SC]]$ 
                    is defined by \cref{lemma:merge-completeness},
                    since $[[ Θ   ⊢ uσ0 : SC1 ]]$ and $[[ Θ   ⊢ uσ0 : SC2 ]]$.
            \end{enumerate}

        \item \ruleref{\ottdruleDTAppLetLabel}\\
            By assumption, $[[c]]$ is $[[let x = v(args); c']]$. 
            Then by inversion of
            $[[Γ ; Φ ⊢ let x = v(args); c' : iN]]$: 
            \begin{itemize}
                \item $[[Γ ; Φ ⊢ v : ↓iM]]$, 
                    which by the induction hypothesis means 
                    $[[Γ; Φ ⊨ v : ↓nf(iM)]]$;
                \item $[[Γ ; Φ ⊢ iM ● args ⇒> ↑iQ uniq]]$. 
                    Then by \cref{lemma:app-inf-equ-stable}, since 
                    $[[Γ ⊢ iM ≈ nf(iM)]]$, we have
                    $[[Γ ; Φ ⊢ nf(iM) ● args ⇒> ↑iQ]]$
                    and moreover, $[[Γ ; Φ ⊢ nf(iM) ● args ⇒> ↑iQ uniq]]$
                    (since symmetrically, $[[nf(iM)]]$ can be replaced back by $[[iM]]$).
                    Then the induction hypothesis applied to 
                    $[[Γ ; Φ ⊢ [·]nf(uM) ● args ⇒> ↑iQ]]$
                    implies that there exist $[[uM']]$, $[[Θ]]$, and $[[SC]]$ such that
                    (considering $[[iM]]$ is ground):
                    \begin{enumerate}
                        \item $[[ Γ; Φ; · ⊨ nf(uM) ● args ⇒> uM' ⫤ Θ; SC ]]$, 
                            which, by the soundness, implies, in particular
                            that 
                            \begin{enumerate}
                                \item $[[Γ; dom(Θ) ⊢  uM']]$ is normalized and 
                                    free of negative algorithmic variables, 
                                \item $[[Θ|uv(uM') ⊢ SC]]$, which means $[[dom(SC) ⊆ uv(uM')]]$,
                                \item \label{point:typing-completeness:AppLet:ih-sound} 
                                    for any $[[Θ ⊢ uσ : uv uM' ]]$ such that $[[ Θ ⊢ uσ : SC ]]$, 
                                    we have $[[ Γ ; Φ ⊢ nf(iM) ● args ⇒> [uσ]uM' ]]$,
                                    which, since $[[Γ ; Φ ⊢ nf(iM) ● args ⇒> ↑iQ uniq]]$,
                                    means $[[Γ ⊢ [uσ]uM' ≈ ↑iQ]]$.
                            \end{enumerate}
                            and
                        \item for any $[[Γ ⊢ iM'']]$
                            such that $[[Γ; Φ ⊢ nf(iM) ● args ⇒> iM'']]$,
                            (and in particular, for $[[Γ ⊢ ↑iQ]]$)
                            there exists $[[uσ1]]$ such that 
                            \begin{enumerate}
                                \item 
                                    $[[ Θ  ⊢ uσ1 : uv uM' ]]$,
                                    $[[ Θ  ⊢ uσ1 : SC ]]$, and 
                                \item $[[Γ ⊢ [uσ1]uM' ≈ iM'']]$, and 
                                    in particular, $[[Γ ⊢ [uσ1]uM' ≈ ↑iQ]]$.
                                    Since $[[uM']]$ is
                                    normalized and free of 
                                    negative algorithmic variables, it means that 
                                    $[[uM' = ↑uP]]$ for some $[[uP]]$ 
                                    ($[[Γ; dom(Θ) ⊢  uP]]$)
                                    that is $[[Γ ⊢ [uσ1]uP ≈ iQ]]$.
                            \end{enumerate}
                    \end{enumerate}
                \item $[[Γ; Φ, x:iQ ⊢ c' : iN]]$
            \end{itemize}

            To infer $[[Γ ; Φ ⊨ let x = v(args); c' : nf(iN)]]$, 
            let us apply the corresponding algorithmic rule 
            (\ruleref{\ottdruleATAppLetLabel}):
            \begin{enumerate}
                \item $[[Γ ; Φ ⊨ v : ↓nf(iM)]]$ holds as noted above;

                \item $[[Γ; Φ ; · ⊨ nf(uM) ● args ⇒> ↑uP ⫤ Θ; SC]]$ holds as noted above;

                \item To show $[[uv uP = dom(SC)]]$ and 
                    $[[SC singular with uσ0]]$ for some $[[uσ0]]$,
                    we apply \cref{lemma:singularity-completeness}
                    with $[[Ξ = uv uP]] = [[uv(uM')]]$ (as noted above, $[[dom(SC) ⊆ uv(uM')]] = [[Ξ]]$).

                    Now we will show that any substitution satisfying $[[SC]]$ is equivalent to $[[uσ1]]$.
                    As noted in \ref{point:typing-completeness:AppLet:ih-sound},
                    for any substitution $[[Θ ⊢ uσ : Ξ]]$, $[[ Θ ⊢ uσ : SC ]]$ implies 
                    $[[Γ ⊢ [uσ]uM' ≈ ↑iQ]]$,
                    which is rewritten as $[[Γ ⊢ [uσ]uP ≈ iQ]]$.
                    And since $[[Γ ⊢ [uσ1]uP ≈ iQ]]$, 
                    we have $[[Γ ⊢ [uσ]uP ≈ [uσ1]uP]]$,
                    which implies $[[Θ ⊢ uσ ≈ uσ1 : Ξ]]$ by \cref{lemma:subst-equiv-algovar}.

                \item Let us show $[[Γ; Φ, x:[uσ0]uP ⊨ c' : nf(iN)]]$.
                    By the soundness of singularity 
                    (\cref{lemma:singularity-soundness}),
                    we have $[[ Θ ⊢ uσ0 : SC ]]$,
                    which by \ref{point:typing-completeness:AppLet:ih-sound}
                    means $[[Γ ⊢ [uσ0]uM' ≈ ↑iQ]]$,
                    that is $[[Γ ⊢ [uσ0]uP ≈ iQ]]$, 
                    and thus, $[[Γ ⊢ Φ, x:iQ ≈ Φ, x:[uσ0]uP]]$.

                    Then by \cref{lemma:decl-typing-context-equiv},
                    $[[Γ; Φ, x:iQ ⊢ c' : iN]]$ can be rewritten as
                    $[[Γ; Φ, x:[uσ0]uP ⊢ c' : iN]]$.
                    Then by the induction hypothesis applied to it, 
                    $[[Γ; Φ, x:[uσ0]uP ⊨ c' : nf(iN)]]$ holds.
            \end{enumerate}

        \item \ruleref{\ottdruleDTForallAppLabel}\\
            Since $[[uN]]$ cannot be a algorithmic variable,  
            if $[[ [uσ]uN ]]$ starts with $[[∀]]$,
            so does $[[uN]]$. This way,
            $[[uN = ∀pas.uN1]]$.
            Then by assumption:
            \begin{enumerate}
                \item $[[Γ ⊢ Θ]]$
                \item $[[Γ; dom(Θ) ⊢  ∀pas.uN1]]$ is free from negative algorithmic variables, 
                    and then $[[Γ, pas; dom(Θ) ⊢  uN1]]$ is free from negative algorithmic variables too;
                \item $[[Θ ⊢ uσ : uv uN1]]$;
                \item $[[Γ ⊢ iM]]$;
                \item $[[Γ; Φ ⊢ [uσ]∀pas.uN1 ● args ⇒> iM]]$, 
                    \label{point:typing-completeness-forall-app-inversion}
                    that is $[[Γ; Φ ⊢ (∀pas.[uσ]uN1) ● args ⇒> iM]]$.
                    Then by inversion there exists $[[σ]]$ such that 
                    \begin{enumerate}
                        \item $[[Γ ⊢ σ : {pas}]]$;
                        \item $[[args ≠ ·]]$ and $[[pas ≠ ·]]$; and
                        \item $[[Γ ; Φ ⊢ [σ][uσ]uN1 ● args ⇒> iM]]$.
                            \label{point:typing-completeness-forall-app-inversion-2}
                            Notice that $[[σ]]$ and $[[uσ]]$ commute because 
                            the codomain of $[[σ]]$ does not contain
                            algorithmic variables (and thus, does not intersect with 
                            the domain of $[[uσ]]$), and the codomain of $[[uσ]]$ is 
                            $[[Γ]]$ and does not intersect with $[[pas]]$---the domain of $[[σ]]$.

                            Let us construct $[[uN0]]$ = $[[ [â⁺*/pas]uN1 ]]$
                            and $[[Θ, â⁺*[Γ] ⊢ uσ0 : uv(uN0)]]$ defined as
                            $$
                            \begin{cases}
                                [[ [uσ0]αî⁺ = [σ]αi⁺ ]] & \text{for $[[αî⁺]] \in  [[{â⁺*} ∩ uv uN0]]$ }\\
                                [[ [uσ0]β̂± = [uσ]β̂± ]] & \text{for $[[β̂±]] \in [[uv uN1]]$}
                            \end{cases}
                            $$

                            Then it is easy to see that $[[ [uσ0][â⁺*/pas]uN1 = [σ][uσ]uN1 ]]$
                            because this substitution compositions coincide on
                            $[[uv(uN1)]] \cup [[fv(uN1)]]$. 
                            In other words, $[[ [uσ0]uN0 = [σ][uσ]uN1 ]]$.

                            Then let us apply the induction hypothesis
                            to $[[Γ; Φ ⊢ [uσ0]uN0 ● args ⇒> iM]]$ and obtain 
                            $[[uM']]$, $[[Θ']]$, and $[[SC]]$ such that
                            \begin{itemize}
                                \item $[[ Γ; Φ; Θ, â⁺*[Γ] ⊨ uN0 ● args ⇒> uM' ⫤ Θ'; SC ]]$ and
                                \item \label{point:typing-completeness-forall-app-inversion-3}
                                for any $[[Θ, â⁺*[Γ]  ⊢ uσ0 : uv(uN0)]]$ and $[[Γ ⊢ iM]]$
                                    such that $[[Γ; Φ ⊢ [uσ0]uN0 ● args ⇒> iM]]$, 
                                    there exists $[[uσ0']]$ such that 
                                \begin{enumerate}
                                    \item $[[Θ'  ⊢uσ0' : uv(uN0) ∪ uv(uM')]]$, $[[ Θ' ⊢ uσ0'  : SC ]] $,
                                    \item $[[Θ, â⁺*[Γ] ⊢ uσ0' ≈ uσ0 : uv uN0]]$, and 
                                    \item $[[Γ ⊢ [uσ0']uM' ≈ iM]]$.
                                \end{enumerate}
                            \end{itemize}
                    \end{enumerate}
            \end{enumerate}
            Let us take $[[uM']]$, $[[Θ']]$, and $[[SC]]$ from the induction hypothesis
            (\ref{point:typing-completeness-forall-app-inversion-2}) 
            (from $[[SC]]$ we subtract entries restricting $[[{â⁺*}]]$)
            and show they satisfy the required properties 
            \begin{enumerate}
                \item To infer $[[ Γ; Φ; Θ ⊨ ∀pas.uN1 ● args ⇒> uM' ⫤ Θ'; SC \ {â⁺*} ]]$
                    we apply the corresponding algorithmic rule \ruleref{\ottdruleATForallAppLabel}.
                    As noted above, the required premises hold:
                    \begin{enumerate}
                        \item $[[args ≠ ·]]$, $[[pas ≠ ·]]$; and
                        \item $[[Γ; Φ; Θ, â⁺*[Γ] ⊨ [â⁺*/pas]uN1 ● args ⇒> uM' ⫤ Θ'; SC]]$
                            is obtained by unfolding the definition of $[[uN0]]$
                            in $[[ Γ; Φ; Θ, â⁺*[Γ] ⊨ uN0 ● args ⇒> uM' ⫤ Θ'; SC ]]$
                            (\ref{point:typing-completeness-forall-app-inversion-2}).
                    \end{enumerate}
                \item Let us take and arbitrary $[[Θ ⊢ uσ : uv uN1]]$ and $[[Γ ⊢ iM]]$
                    and assume $[[Γ; Φ ⊢ [uσ]∀pas.uN1  ● args ⇒> iM]]$. 
                    Then the same reasoning as in 
                    \ref{point:typing-completeness-forall-app-inversion-2}
                    applies. In particular, we construct 
                    $[[Θ, â⁺*[Γ] ⊢ uσ0 : uv(uN0)]]$ 
                        as an extension of $[[uσ]]$ and obtain 
                    $[[Γ; Φ ⊢ [uσ0]uN0 ● args ⇒> iM]]$.

                    It means we can apply the property inferred from the induction 
                    hypothesis (\ref{point:typing-completeness-forall-app-inversion-3})
                    to obtain $[[uσ0']]$ such that 
                    \begin{enumerate}
                        \item $[[Θ' ⊢ uσ0' : uv(uN0) ∪ uv(uM')]]$ and $[[ Θ'  ⊢ uσ0' : SC ]] $,
                        \item $[[Θ, â⁺*[Γ] ⊢ uσ0' ≈ uσ0 : uv uN0]]$, and 
                        \item $[[Γ ⊢ [uσ0']uM' ≈ iM]]$.
                    \end{enumerate}

                    Let us show that $[[uσ0'|(uv(uN1) ∪ uv(uM'))]]$ 
                    satisfies the required properties.
                    \begin{enumerate}
                        \item $[[Θ' ⊢ uσ0'|(uv(uN1) ∪ uv(uM')): (uv(uN1) ∪ uv(uM'))]]$
                            holds since $[[ Θ' ⊢ uσ0' : uv(uN0) ∪ uv(uM')]]$
                            and $[[uv(uN1) ∪ uv(uM') ⊆ uv(uN0) ∪ uv(uM')]]$;
                            $[[ Θ' ⊢ uσ0'|(uv(uN1) ∪ uv(uM')) : SC \ {â⁺*} ]]$ holds since
                            $[[ Θ' ⊢ uσ0' : SC ]]$,
                            $[[ Θ' ⊢ uσ0' : uv(uN0) ∪ uv(uM') ]]$,
                            and $[[(uv(uN0) ∪ uv(uM')) \ {â⁺*} = uv(uN1) ∪ uv(uM')]]$.

                        \item $[[Γ ⊢ [uσ0']uM' ≈ iM]]$ holds as shown,
                            and hence it holds for $[[uσ0'|(uv(uN1) ∪ uv(uM'))]]$;
                        \item We show $[[Θ ⊢ uσ0' ≈ uσ : uv uN1]]$, from which
                            it follows that it holds for $[[uσ0'|(uv(uN1) ∪ uv(uM'))]]$.
                            Let us take an arbitrary 
                            $[[β̂±]] \in [[dom(Θ)]] \subseteq [[dom(Θ) ∪ {â⁺*}]]$. Then 
                            since $[[Θ, â⁺*[Γ] ⊢ uσ0' ≈ uσ0 : uv uN0]]$, 
                            we have $[[Θ(β̂±) ⊢ [uσ0']β̂±  ≈ [uσ0]β̂± ]]$ and 
                            by definition of $[[uσ0]]$, $[[ [uσ0]β̂±  = [uσ]β̂± ]]$.
                    \end{enumerate}
            \end{enumerate}
           
        \item \ruleref{\ottdruleDTArrowAppLabel}\\
            Since $[[uN]]$ cannot be a algorithmic variable,  
            if the shape of $[[ [uσ]uN ]]$ is an arrow, 
            so is the shape of $[[uN]]$. This way, 
            $[[uN = uQ → uN1]]$.
            Then by assumption:
            \begin{enumerate}
                \item $[[Γ ⊢ Θ]]$;
                \item $[[Γ; dom(Θ) ⊢  uQ → uN1]]$ is free from negative algorithmic variables;
                \item $[[Θ ⊢ uσ : uv uQ ∪ uv uN1]]$;
                \item $[[Γ ⊢ iM]]$;
                \item $[[Γ; Φ ⊢ [uσ](uQ → uN1) ● v, args ⇒> iM]]$, 
                    \label{point:typing-completeness-arrow-app-inversion}
                    that is $[[Γ; Φ ⊢ ([uσ]uQ → [uσ]uN1) ● v, args ⇒> iM]]$,
                    and by inversion:
                    \begin{enumerate}
                        \item $[[Γ; Φ ⊢ v : iP]]$,
                            and by the induction hypothesis, 
                            $[[Γ; Φ ⊨ v : nf(iP)]]$;
                        \item $[[Γ ⊢ [uσ]uQ ≥ iP]]$, 
                            which by transitivity (\cref{lemma:subtyping-transitivity}) means 
                            $[[Γ ⊢ [uσ]uQ ≥ nf(iP)]]$,
                            and then by completeness of subtyping 
                            (\cref{lemma:pos-subt-completeness}),
                            $[[ Γ; Θ ⊨ uQ ≥ nf(iP) ⫤ SC1 ]]$, 
                            for some $[[Θ ⊢ SC1 : uv(uQ)]]$, and moreover, $[[ Θ ⊢ uσ : SC1 ]]$;
                        \item $[[Γ; Φ ⊢ [uσ]uN1 ● args ⇒> iM]]$. 
                            \label{point:completeness-arrow-app-ih}
                            Notice that the induction hypothesis is applicable to this case:
                            $[[Γ ; dom(Θ) ⊢  uN1]]$ is free from negative algorithmic variables because
                            so is $[[uQ → uN1]]$. This way, there exist 
                            $[[uM']]$, $[[Θ']]$, and $[[SC2]]$ such that 
                            \begin{enumerate}
                                \item $[[ Γ; Φ; Θ ⊨ uN1 ● args ⇒> uM' ⫤ Θ'; SC2 ]]$
                                    and then by soundness of typing 
                                    (i.e. the induction hypothesis), 
                                    \begin{enumerate}
                                        \item $[[Θ ⊆ Θ']]$
                                        \item $[[Γ; dom(Θ') ⊢  uM']]$
                                        \item $[[dom(Θ) ∩ uv(uM') ⊆ uv uN1]]$
                                        \item $[[Θ'|uv uN1 ∪ uv uM' ⊢ SC2]]$
                                    \end{enumerate}
                                \item  \label{point:new-subdst}
                                    for any $[[Θ ⊢ uσ : uv(uN1)]]$ and $[[Γ ⊢ iM]]$
                                    such that $[[Γ; Φ ⊢ [uσ]uN1 ● args ⇒> iM]]$, 
                                    there exists $[[uσ']]$ such that 
                                    \begin{enumerate}
                                        \item $[[Θ' ⊢ uσ' : uv(uN1) ∪ uv(uM')]]$ and $[[Θ' ⊢ uσ' : SC2]]$,
                                        \item $[[Θ ⊢ uσ' ≈ uσ : uv(uN1)]]$, and 
                                        \item $[[Γ ⊢ [uσ']uM' ≈ iM]]$.
                                    \end{enumerate}
                            \end{enumerate}
                    \end{enumerate}
            \end{enumerate}

            We need to show that there exist $[[uM']]$, $[[Θ']]$, and $[[SC]]$ such that
            $[[ Γ; Φ; Θ ⊨ uQ → uN1 ● v, args ⇒> uM' ⫤ Θ'; SC ]]$ and
            the initiality property holds. 
            We take $[[uM']]$ and $[[Θ']]$ from the induction hypothesis
            (\ref{point:completeness-arrow-app-ih}), and $[[SC]]$
            as a merge of $[[SC1]]$ and $[[SC2]]$.
            To show that $[[Θ' ⊢ SC1 & SC2 = SC]]$ exists,
            we apply \cref{lemma:merge-completeness}.
            To do so, we need to provide 
            a substitution satisfying both 
            $[[SC1]]$ and $[[SC2]]$.

            Notice that $[[dom(SC1) = uv(uQ)]]$ and
            $[[dom(SC2) ⊆ uv uN1 ∪ uv uM']]$.
            This way, it suffices to construct 
            $[[Θ' ⊢ uσ'' : uv(uQ) ∪ uv uN1 ∪ uv uM']]$ such that
            $[[Θ' ⊢ uσ'' : SC1]]$ and $[[Θ' ⊢ uσ'' : SC2]]$.

            By the induction hypothesis (\ref{point:new-subdst}),
            $[[uσ|uv(uN1)]]$
            can be extended to $[[uσ']]$ such that
            \begin{enumerate}
                \item $[[Θ' ⊢ uσ' : uv(uN1) ∪ uv(uM')]]$ and $[[Θ' ⊢ uσ' : SC2]]$,
                \item $[[Θ ⊢ uσ' ≈ uσ: uv(uN1)]]$, and 
                \item $[[Γ ⊢ [uσ']uM' ≈ iM]]$.
            \end{enumerate}
            Let us extend $[[uσ']]$ to $[[uσ'']]$
            defined on $[[uv(uQ) ∪ uv(uN1) ∪ uv(uM')]]$
            with values of $[[uσ]]$ as follows:
            $$
            \begin{cases}
                [[ [uσ'']β̂± = [uσ']β̂± ]] & \text{for $[[β̂±]] \in [[uv(uN1) ∪ uv(uM')]]$}\\
                [[ [uσ'']γ̂± = [uσ]γ̂± ]] & \text{for $[[γ̂±]] \in [[uv(uQ) \ (uv(uN1) ∪ uv(uM'))]]$}
            \end{cases}
            $$

            First, notice that $[[Θ' ⊢ uσ'' ≈ uσ' : uv(uN1) ∪ uv(uM')]]$
            by definition.
            Then since $[[Θ' ⊢ uσ' : SC2]]$ and
            $[[Θ' ⊢ SC2 : uv(uN1) ∪ uv(uM')]]$, 
            we have $[[Θ' ⊢ uσ'' : SC2]]$.

            Second, notice that $[[Θ ⊢ uσ'' ≈ uσ : uv(uN1) ∪ uv(uQ)]]$:
            \begin{itemize}
                \item if $[[γ̂±]] \in [[uv(uQ) \ (uv(uN1) ∪ uv(uM'))]]$
                    then $[[ [uσ'']γ̂± = [uσ]γ̂± ]]$ by definition of $[[uσ'']]$;
                \item if $[[γ̂±]] \in [[uv(uQ) ∩ uv(uN1)]]$
                    then $[[ [uσ'']γ̂± = [uσ']γ̂± ]]$,
                    and $[[Θ ⊢ uσ' ≈ uσ: uv(uN1)]]$, as noted above;
                \item if $[[γ̂±]] \in [[uv(uQ) ∩ uv(uM')]]$
                    then since $[[Γ; dom(Θ) ⊢  uQ]]$, 
                    we have $[[uv(uQ) ⊆ dom(Θ)]]$,
                    implying 
                    $[[γ̂±]] \in [[dom(Θ) ∩ uv(uM') ⊆ uv(uN1)]]$.
                    This way, $[[γ̂±]] \in [[uv(uQ) ∩ uv(uN1)]]$, 
                    and this case is covered by the previous one.
            \end{itemize}
            In particular, $[[Θ ⊢ uσ'' ≈ uσ : uv(uQ)]]$.
            Then since $[[Θ ⊢ uσ : SC1]]$ and $[[Θ ⊢ SC1 : uv(uQ)]]$,
            we have $[[Θ ⊢ uσ'' : SC1]]$.

            This way, $[[uσ']]$ satisfies both $[[SC1]]$ and $[[SC2]]$,
            and by the completeness of constraint merge 
            (\cref{lemma:merge-completeness}),
            $[[Θ' ⊢ SC1 & SC2 = SC]]$ exists.


            Finally, to show the required properties, we take
            $[[uM']]$ and $[[Θ']]$ from the induction hypothesis (\ref{point:new-subdst}), 
            and $[[SC]]$ defined above. Then
            \begin{enumerate}
                \item $[[ Γ; Φ; Θ ⊨ uQ → uN1 ● v,args ⇒> uM' ⫤ Θ'; SC ]]$
                    is inferred by \ruleref{\ottdruleATArrowAppLabel}.
                    As noted above:
                    \begin{enumerate}
                        \item $[[Γ; Φ ⊨ v : nf(iP)]]$,
                        \item $[[Γ; Θ ⊨ uQ ≥ nf(iP) ⫤ SC1]]$,
                        \item $[[Γ; Φ; Θ ⊨ uN1 ● args ⇒> uM' ⫤ Θ'; SC2]]$, and
                        \item $[[Θ' ⊢ SC1 & SC2 = SC]]$.
                    \end{enumerate}
                \item let us take an arbitrary 
                    $[[Θ ⊢ uσ0 : uv uQ ∪ uv uN1]]$;
                    and $[[Γ ⊢ iM0]]$;
                    such that $[[Γ; Φ ⊢ [uσ0](uQ → uN1) ● v,args ⇒> iM0]]$.
                    Then by inversion of 
                    $[[Γ; Φ ⊢ [uσ0]uQ → [uσ0]uN1 ● v, args ⇒> iM0]]$,
                    we have the same properties as in 
                    \ref{point:typing-completeness-arrow-app-inversion}.
                    In particular,
                    \begin{itemize}
                        \item $[[Γ ⊢ [uσ0]uQ ≥ nf(iP)]]$
                            and by the completeness of subtyping 
                            (\cref{lemma:pos-subt-completeness}),
                            $[[ Θ  ⊢ uσ0 : SC1  ]]$.
                        \item $[[Γ; Φ ⊢ [uσ0]uN1 ● args ⇒> iM0]]$. 
                            Then by \ref{point:new-subdst}, 
                            there exists $[[uσ0']]$ such that 
                            \begin{enumerate}
                                    \item $[[Θ' ⊢ uσ0' : uv(uN1) ∪ uv(uM')]]$ and 
                                        $[[Θ' ⊢ uσ0' : SC2]]$,
                                    \item $[[Θ ⊢ uσ0' ≈ uσ0 : uv(uN1)]]$, and 
                                    \item $[[Γ ⊢ [uσ0']uM' ≈ iM0]]$.
                            \end{enumerate}
                    \end{itemize}
                    Let us extend $[[uσ0']]$ to be defined on
                    $[[uv(uQ) ∪ uv(uN1) ∪ uv(uM')]]$
                    with the values of $[[uσ0]]$.
                    We define $[[uσ0'']]$ as follows:
                    $$
                    \begin{cases}
                        [[ [uσ0'']γ̂± = [uσ0']γ̂± ]] & \text{for $[[γ̂±]] \in [[uv(uN1) ∪ uv(uM')]]$}\\
                        [[ [uσ0'']γ̂± = [uσ0]γ̂± ]] & \text{for $[[γ̂±]] \in [[uv(uQ) \ (uv(uN1) ∪ uv(uM'))]]$}
                    \end{cases}
                    $$
                    This way, 
                    \begin{itemize}
                        \item $[[Θ' ⊢ uσ0'' : uv(uQ) ∪ uv(uN1) ∪ uv(uM')]]$,
                        \item $[[Θ' ⊢ uσ0'' : SC]]$,
                            since $[[Θ' ⊢ uσ0'' : SC1]]$ and $[[Θ' ⊢ uσ0'' : SC2]]$,
                            which is proved similarly to
                            $[[Θ' ⊢ uσ'' : SC1]]$ and $[[Θ' ⊢ uσ'' : SC2]]$ above;
                        \item $[[Θ ⊢ uσ0'' ≈ uσ0 : uv(uN1) ∪ uv(uQ)]]$:
                            the proof is analogous to
                            $[[Θ ⊢ uσ'' ≈ uσ : uv(uN1) ∪ uv(uQ)]]$ above.
                        \item $[[Γ ⊢ [uσ0'']uM' ≈ iM0]]$
                            Notice that $[[Θ' ⊢ uσ0'' ≈ uσ0' : uv(uN1) ∪ uv(uM')]]$,
                            which is proved analogously to
                            $[[Θ' ⊢ uσ'' ≈ uσ' : uv(uN1) ∪ uv(uM')]]$ above.
                            Then $[[Γ ⊢ [uσ0']uM' ≈ iM0]]$
                            can be rewritten to $[[Γ ⊢ [uσ0'']uM' ≈ iM0]]$.
                    \end{itemize}
            \end{enumerate}
            


        \item \ruleref{\ottdruleDTEmptyAppLabel}\\
            By assumption: 
            \begin{enumerate}
                \item $[[Γ ⊢ Θ]]$,
                \item $[[Γ ⊢ iN']]$,
                \item $[[Γ; dom(Θ) ⊢ uN]]$ and $[[uN]]$ is free from negative variables,
                \item $[[Θ ⊢ uσ : uv(uN)]]$,
                \item $[[Γ; Φ ⊢ [uσ]uN ● · ⇒> iN' ]]$,
                    and by inversion, $[[Γ ⊢ [uσ]uN ≈ iN']]$.
            \end{enumerate}


            Then we can apply the corresponding algorithmic rule
            \ruleref{\ottdruleATEmptyAppLabel} to infer
            $[[ Γ; Φ; Θ ⊨ uN ● · ⇒> nf(uN) ⫤ Θ; · ]]$.
            Let us show the required properties. 
            Let us take an arbitrary 
            $[[Θ ⊢ uσ0 : uv(uN)]]$ and $[[Γ ⊢ iM]]$
            such that $[[Γ; Φ ⊢ [uσ1]uN ● · ⇒> iM]]$. 
            Then we can take $[[uσ0]]$ as the required substitution:
            \begin{enumerate}
                \item $[[ Θ ⊢ uσ0 : uv(uN) ∪ uv(nf(uN)) ]]$,
                    since $[[uv(nf(uN)) = uv(uN)]]$, 
                    and thus, $[[uv(uN) ∪ uv(nf(uN)) = uv(uN)]]$;
                \item $[[ Θ ⊢ uσ0 : · ]]$ vacuously;
                \item $[[Θ ⊢ uσ0 ≈ uσ0 : uv(uN)]]$ by reflexivity;
                \item Let us show $[[Γ ⊢ [uσ0]nf(uN) ≈ iM]]$.
                    Notice that $[[Γ; Φ ⊢ [uσ0]uN ● · ⇒> iM]]$ can only be inferred by 
                    \ruleref{\ottdruleDTEmptyAppLabel}, and thus, $[[ Γ ⊢ [uσ0]uN ≈ iM ]]$.
                    By \cref{corollary:nf-pres-subt},
                    $[[Γ ⊢ [uσ0]uN ≈ [uσ0]nf(uN)]]$,
                    and then by transitivity, $[[Γ ⊢ [uσ0]nf(uN) ≈ iM]]$,
                    that is $[[Γ ⊢ [uσ0]nf(uN) ≈ iM]]$.
            \end{enumerate}
    \end{caseof}
\end{proof}
