\begin{lemma}[Substitution strengthening]
  \label{lemma:subst-restr-fv}
  Restricting the substitution to the free variables of the
  substitution subject does not affect the result.
  Suppose that $[[σ]]$ is a substitution,
  $[[iP]]$ and $[[iN]]$ are types. Then
 \begin{itemize}
    \item[$+$] $[[ [σ]iP ]] = [[ [σ|fv iP]iP ]]$,
    \item[$-$] $[[ [σ]iN ]] = [[ [σ|fv iN]iN ]]$
  \end{itemize}
\end{lemma}
\begin{proof}
  First, we strengthen the statement by saying that
  one can restrict the substitution to an arbitrary
  superset of the free variables of the substitution subject:
 \begin{itemize}
    \item[$+$] $[[ [σ]iP ]] = [[ [σ|varset]iP ]]$, for any $[[varset]] \supseteq [[fv iP]]$, and
    \item[$-$] $[[ [σ]iN ]] = [[ [σ|varset]iN ]]$, for any $[[varset]] \supseteq [[fv iN]]$.
  \end{itemize}
  Then the proof is a straightforward induction on $[[iP]]$ and mutually, on $[[iN]]$.
  For the base cases: 
  \begin{caseof}
    \item $[[iN = α⁻]]$\\
      Then $[[ [σ]α⁻ ]] = [[σ|varset]] ([[α⁻]])$ by definition, 
      since $[[α⁻]] \in [[fv α⁻ ⊆ varset]]$.
    \item $[[iN = iP → iM]]$\\
      Then $[[ [σ](iP → iM) ]] = [[ [σ]iP → [σ]iM ]]$ by definition.
      Since $[[fv iP]] \subseteq [[fv(iP → iM)]] \subseteq [[varset]]$, 
      the induction hypothesis is applicable to $[[ [σ]iP ]]$: 
      $[[ [σ]iP ]] = [[ [σ|varset]iP ]]$. 
      Analogously, and $[[ [σ]iM ]] = [[ [σ|varset]iM ]]$.
      Then 
      $[[ [σ](iP → iM) ]] = [[ [σ|varset]iP → [σ|varset]iM ]]
       = [[ [σ|varset](iP → iM) ]]$.
    \item $[[iN = ↑iP]]$ is proved analogously to the previous case.
    \item $[[iN = ∀pas.iM ]]$ (where $[[pas]]$ is not empty)\\
      Then $[[ [σ]∀pas.iM ]] = [[ ∀pas.[σ]iM ]]$ by definition.
      Let us assume $[[pas]]$ are fresh variables, 
      it means that $[[σ]]([[α± ]]) = [[α± ]]$ for any 
      $[[α± ]] \in [[pas]]$, and thus, 
      $[[ [σ|varset] ]] = [[ [σ|(varset ∪ {pas})] ]]$
      immediately from the definition. 

      Since $[[varset ⊆ fv(∀pas.iM)]] = [[fv iM \ {pas}]]$,
      $[[varset ∪ {pas} ⊆ fv(iM)]]$.
      Then by the induction hypothesis, 
      $[[ [σ]iM =  [σ|(varset ∪ {pas})]iM ]]$.
      Finally, 
      $[[ [σ]∀pas.iM ]] = [[ ∀pas.[σ|(varset ∪ {pas})]iM ]] = 
      [[ ∀pas.[σ|varset]iM ]] = [[ [σ|varset]∀pas.iM ]]$.
    \item The positive cases are proves symmetrically. 
  \end{caseof}
\end{proof}

\begin{lemma}[Signature of a restricted substitution]
  \label{lemma:subst-restr-sig}
  If $[[Γ2 ⊢ σ : Γ1]]$ then $[[Γ2 ⊢ σ|varset : Ord {Γ1} ∩ varset]]$.
\end{lemma}
\begin{proof}
  Let us take an arbitrary $[[α± ∊ {Γ1} ∩ varset]]$.
  Since $[[α± ∊ {Γ1}]]$, $[[Γ2 ⊢ [σ]α± ]]$ by the signature of $[[σ]]$.

  Let us take an arbitrary $[[α± ∉ {Γ1} ∩ varset]]$.
  If $[[α± ∉ varset]]$ then $[[ [σ|varset]α± ]] = [[α±]]$ by definition
  of restriction. 
  If $[[α± ∊ varset \ {Γ1}]]$ then $[[ [σ|varset]α± ]] = [[ [σ]α± ]]$ by definition
  and $[[ [σ]α± ]] = [[α±]]$ by the signature of $[[σ]]$.
\end{proof}

\begin{lemma}
  Suppose that $[[σ]]$ is a substitution with signature $[[Γ2 ⊢ σ : Γ1]]$. 
  Then if $[[varset]]$ is disjoint from $[[Γ1]]$, 
  then $[[ σ|varset]] = [[ id ]]$. 
\end{lemma}
\begin{proof}
  Let us take an arbitrary $[[α±]]$.
  If $[[α± ∉ varset]]$ then $[[ [σ|varset]α±]] = [[α±]]$ by definition.

  If $[[α± ∊ varset]]$ then $[[α± ∉ {Γ1}]]$ by assumption.
  Then $[[ [σ|varset]α± = [σ]α±]]$ by definition of restricted substitution, and
  since $[[Γ2 ⊢ σ : Γ1]]$, we have $[[ [σ]α± = α± ]]$.
\end{proof}

\begin{corollary}[Application of a disjoint substitution]
  \label{corollary:subst-disj}
  Suppose that $[[σ]]$ is a substitution with signature $[[Γ2 ⊢ σ : Γ1]]$. Then
  \begin{itemize}
    \item [$+$] if $[[{Γ1} ∩ fv(iQ) = ∅]]$ then $[[ [σ] iQ = iQ]]$;
    \item [$-$] if $[[{Γ1} ∩ fv(iN) = ∅]]$ then $[[ [σ] iN = iN]]$.
  \end{itemize}
\end{corollary}

\begin{lemma}[Substitution range weakening]
  \label{lemma:subst-range-weakening}
  Suppose that $[[{Γ2} ⊆ {Γ'2}]]$ are contexts and 
  $[[σ]]$ is a substitution.
  Then $[[Γ2 ⊢ σ : Γ1]]$ implies $[[Γ'2 ⊢ σ : Γ1]]$.
\end{lemma}
\begin{proof}
  For any $[[α± ∊ {Γ1}]]$, 
  $[[Γ2 ⊢ σ : Γ1]]$ gives us  $[[ Γ2 ⊢ [σ]α± ]]$, which can be
  weakened to $[[ Γ'2 ⊢ [σ]α± ]]$ by \cref{lemma:wf-weakening}. 
  This way, $[[Γ'2 ⊢ σ : Γ1]]$.
\end{proof}

\begin{lemma}[]
  Suppose that $[[{Γ'} ⊆ {Γ}]]$,
  $[[σ1]]$ and $[[σ2]]$ are substitutions of signature $[[Γ ⊢ σi : Γ']]$.
  Then 
  \begin{enumerate}
    \item [$+$] for a type $[[Γ ⊢ iP]]$, if $[[Γ ⊢ [σ1]iP ≈ [σ2]iP]]$ then 
    $[[Γ ⊢ σ1 ≈ σ2 : fv iP ∩ {Γ'}]]$;
    \item [$-$] for a type $[[Γ ⊢ iN]]$, if $[[Γ ⊢ [σ1]iN ≈ [σ2]iN]]$ then
    $[[Γ ⊢ σ1 ≈ σ2 : fv iN ∩ {Γ'}]]$.
  \end{enumerate}
\end{lemma}
\begin{proof}
  Let us make an additional assumption that $[[σ1]]$, $[[σ2]]$, 
  and the mentioned types are normalized. If they are not,
  we normalize them first.
  
  Notice that the normalization preserves
  the set of free variables (\cref{lemma:fv-nf}),
  well-formedness (\cref{corollary:wf-nf}), 
  and equivalence (\cref{lemma:subt-equiv-algorithmization}), 
  and distributes over substitution (\cref{lemma:norm-subst-distr}). 
  This way, the assumed and desired properties are equivalent to their 
  normalized versions.

  We prove it by induction on the structure of $[[iP]]$ and mutually, $[[iN]]$.
  Let us consider the shape of this type.
  \begin{caseof}
    \item $[[iP]] = [[α⁺]] \in [[Γ']]$.
      Then $[[Γ ⊢ σ1 ≈ σ2 : fv iP ∩ {Γ'}]]$ means $[[Γ ⊢ σ1 ≈ σ2 : {α⁺}]]$, 
      i.e. $[[Γ ⊢ [σ1]α⁺ ≈ [σ2]α⁺ ]]$, which holds by assumption.
    \item $[[iP]] = [[α⁺]] \in [[{Γ} \ {Γ'}]]$.
      Then $[[fv iP ∩ {Γ'}]] = [[∅]]$, 
      so $[[Γ ⊢ σ1 ≈ σ2 : fv iP ∩ {Γ'}]]$ holds vacuously.
    \item $[[iP]] = [[↓iN]]$.
      Then the induction hypothesis is applicable to type $[[iN]]$:
      \begin{enumerate}
        \item $[[iN]]$ is normalized,
        \item $[[Γ ⊢ iN]]$ by inversion of $[[Γ ⊢ ↓iN]]$,
        \item $[[Γ ⊢ [σ1]iN ≈ [σ2]iN]]$ holds by inversion of 
          $[[Γ ⊢ [σ1]↓iN ≈ [σ2]↓iN]]$, i.e. $[[Γ ⊢ ↓[σ1]iN ≈ ↓[σ2]iN]]$.
      \end{enumerate}
      This way, we obtain $[[Γ ⊢ σ1 ≈ σ2 : fv iN ∩ {Γ'}]]$, 
      which implies the required equivalence since 
      $[[fv iP ∩ {Γ'}]] = [[fv ↓iN ∩ {Γ'}]] = [[fv iN ∩ {Γ'}]]$.
    \item $[[iP]] = [[∃nas.iQ]]$
      Then the induction hypothesis is applicable to type $[[iQ]]$ 
      well-formed in context $[[Γ, nas]]$:
      \begin{enumerate}
        \item $[[{Γ'} ⊆ {Γ, nas}]]$ since $[[{Γ'} ⊆ {Γ}]]$,
        \item $[[Γ, nas ⊢ σi : Γ']]$ by weakening,
        \item $[[iQ]]$ is normalized,
        \item $[[Γ, nas ⊢ iQ]]$ by inversion of $[[Γ ⊢ ∃nas.iQ]]$,
        \item Notice that $[[ [σi]∃nas.iQ ]]$ is normalized, and thus, 
          $[[ [σ1]∃nas.iQ ≈ [σ2]∃nas.iQ]]$ implies 
          $[[ [σ1]∃nas.iQ = [σ2]∃nas.iQ ]]$
          (by \cref{lemma:subt-equiv-algorithmization}).).
          This equality means $[[ [σ1]iQ = [σ2]iQ ]]$, 
          which implies $[[Γ ⊢ [σ1]iQ ≈ [σ2]iQ]]$.
      \end{enumerate}
    \item $[[iN]] = [[iP → iM]]$
  \end{caseof}
\end{proof}



\begin{lemma}[Substitutions equal on the metavariables]
  \label{lemma:subst-eq-metavar}
  Suppose that $[[uσ1]]$ and $[[uσ2]]$ are 
  normalized substitutions of signature $[[Θ ⊢ uσi]]$.
  Then 
  \begin{enumerate}
    \item [$+$] for a normalized type $[[Γ; dom(Θ) ⊢ uP]]$, if $[[ [uσ1]uP = [uσ2]uP ]]$ then
      $[[uσ1|(uv uP)  = uσ2|(uv uP)]]$;
    \item [$-$] for a normalized type $[[Γ; dom(Θ) ⊢ uN]]$, if $[[ [uσ1]uN = [uσ2]uN ]]$ then
      $[[uσ1|(uv uN)  = uσ2|(uv uN)]]$.
  \end{enumerate}
\end{lemma}
\begin{proof}
  The proof is a simple structural induction on 
  $[[Γ; dom(Θ) ⊢ uP]]$ and mutually, on $[[Γ; dom(Θ) ⊢ uN]]$.
  Let us consider the shape of $[[uN]]$ (the cases of $[[uP]]$ are symmetric).
  \begin{caseof}
    \item $[[Γ; dom(Θ) ⊢ α̂⁻]]$. Then $[[ [uσ1]α̂⁻ = [uσ2]α̂⁻ ]]$
      implies $[[uσ1|(uv α̂⁻) = uσ2|(uv α̂⁻)]]$ immediately.
    \item $[[Γ; dom(Θ) ⊢ α⁻]]$. Then $[[uv α̂⁻ = ∅]]$, and
      $[[uσ1|(uv α̂⁻)  = uσ2|(uv α̂⁻)]]$ holds vacuously.
    \item $[[Γ; dom(Θ) ⊢ ∀pas.uN]]$. Then we are proving that
      $[[ [uσ1]∀pas.uN = [uσ2]∀pas.uN ]]$ implies $[[uσ1|(uv ∀pas.uN) = uσ2|(uv ∀pas.uN)]]$.
      By definition of substitution and \ruleref{\ottdruleEOneForallLabel}, 
      $[[ [uσ1]uN = [uσ2]uN ]]$ implies $[[uσ1|uv uN = uσ2|uv uN]]$.
      Since $[[∀pas.uN]]$ is normalized, so is $[[Γ, pas; dom(Θ) ⊢ uN]]$, 
      hence, the induction hypothesis is applicable and implies $[[uσ1|uv uN = uσ2|uv uN]]$,
      as required.
    \item $[[Γ; dom(Θ) ⊢ uP → uN]]$. Then we are proving that
      $[[ [uσ1](uP → uN) = [uσ2](uP → uN) ]]$ implies $[[uσ1|(uv uP → uN) = uσ2|(uv uP → uN)]]$.
      By definition of substitution and congruence of equality, 
      $[[ [uσ1](uP → uN) = [uσ2](uP → uN) ]]$
      means $[[ [uσ1]uP = [uσ2]uP ]]$ and $[[ [uσ1]uN = [uσ2]uN ]]$.
      Notice that $[[uP]]$ and $[[uN]]$ are normalized since $[[uP → uN]]$ is normalized, 
      and well-formed in the same contexts.
      This way, by the induction hypothesis, 
      $[[uσ1|(uv uP) = uσ2|(uv uP)]]$ and $[[uσ1|(uv uN) = uσ2|(uv uN)]]$,
      which since $[[uv (uP → uN) = uv uP ∪ uv uN]]$ implies
      $[[uσ1|(uv uP → uN) = uσ2|(uv uP → uN)]]$.
    \item $[[Γ; dom(Θ) ⊢ ↑uP]]$. The proof is similar to the previous case:
      we apply congruence of substitution, equality, and normalization,
      then the induction hypothesis, and then the fact that $[[uv (↑uP) = uv uP]]$.
  \end{caseof}
\end{proof}


\begin{corollary}[Substitutions equivalent on the metavariables]
  \label{lemma:subst-equiv-metavar}
  Suppose that $[[uσ1]]$ and $[[uσ2]]$ are substitutions 
  of signature $[[Θ ⊢ uσi]]$.
  Then 
  \begin{enumerate}
    \item [$+$] for a type $[[Γ; dom(Θ) ⊢ uP]]$, if $[[Θ ⊢ [uσ1]uP ≈ [uσ2]uP]]$ then
      $[[Θ|uv uP ⊢ uσ1 ≈ uσ2]]$;
    \item [$-$] for a type $[[Γ; dom(Θ) ⊢ uN]]$, if $[[Θ ⊢ [uσ1]uN ≈ [uσ2]uN]]$ then
      $[[Θ|uv uN ⊢ uσ1 ≈ uσ2]]$.
  \end{enumerate}
\end{corollary}
\begin{proof}
  First, let us normalize the types and the substitutions, and show that
  the given equivalences and well-formedness properties are preserved. 
  $[[Γ; dom(Θ) ⊢ uP]]$ implies $[[Γ; dom(Θ) ⊢ nf(uP)]]$ by \cref{corollary:wf-nf-algo}.
  $[[Θ ⊢ [uσ1]uP ≈ [uσ2]uP]]$ implies $[[ nf([uσ1]uP) = nf([uσ2]uP)]]$ by 
  \cref{lemma:subt-equiv-algorithmization}.
  Then $[[ nf([uσ1]uP) = nf([uσ2]uP)]]$ implies 
  $[[ [nf(uσ1)]nf(uP) = [nf(uσ2)]nf(uP)]]$ by \cref{lemma:norm-subst-distr}.
  Notice that by \cref{corollary:norm-subst-sig-algo}
  $[[Θ ⊢ uσi]]$ implies $[[Θ ⊢ nf(uσi)]]$.

  This way, by \cref{lemma:subst-eq-metavar}, 
  $[[Θ ⊢ [uσ1]uP ≈ [uσ2]uP]]$ implies 
  $[[nf(uσ1)|(uv nf(uP)) = nf(uσ2)|(uv nf(uP))]]$.
  Then by \cref{lemma:uv-nf}, 
  $[[nf(uσ1)|(uv uP) = nf(uσ2)|(uv uP)]]$,
  and by ${{corollary:subst-subt-equiv-algorithmization}}$,
  $[[Θ|uv uP ⊢ uσ1 ≈ uσ2]]$.

  Symmetrically, 
  $[[Θ ⊢ [uσ1]uN ≈ [uσ2]uN]]$ implies 
  $[[Θ|uv uN ⊢ uσ1 ≈ uσ2]]$.
\end{proof}

\begin{lemma}[Substitution composition well-formedness]
  If $[[Γ'1 ⊢ σ1 : Γ1]]$ and $[[Γ'2 ⊢ σ2 : Γ2]]$,
  then $[[Γ'1, Γ'2 ⊢ σ2 ○ σ1 : Γ1, Γ2]]$.
\end{lemma}

\begin{lemma}[Substitution monadic composition well-formedness]
  \label{lemma:subst-monad-composition-wf}
  If $[[Γ'1 ⊢ σ1 : Γ1]]$ and $[[Γ'2 ⊢ σ2 : Γ2]]$,
  then $[[Γ'2 ⊢ σ2 <=< σ1 : Γ1]]$.
\end{lemma}

\begin{lemma}[Substitution composition]
  \label{lemma:subst-composition}
    If $[[Γ'1 ⊢ σ1 : Γ1]]$, $[[Γ'2 ⊢ σ2 : Γ2]]$, 
    $[[{Γ1} ∩ {Γ'2} = ∅ ]]$ and $[[ {Γ1} ∩ {Γ2} = ∅ ]]$ then 
    $[[ σ2 ○ σ1 ]] = [[ (σ2 <=< σ1) ○ σ2 ]]$.
\end{lemma}

\begin{corollary}[Substitution composition commutativity]
  \label{corollary:subst-composition-commutativity}
  If $[[Γ'1 ⊢ σ1 : Γ1]]$, $[[Γ'2 ⊢ σ2 : Γ2]]$, and
  $[[ {Γ1} ∩ {Γ2} = ∅ ]]$, 
  $[[ {Γ1} ∩ {Γ'2} = ∅ ]]$, and
  $[[ {Γ'1} ∩ {Γ2} = ∅ ]]$ then 
  $[[ σ2 ○ σ1 ]] = [[ σ1 ○ σ2 ]]$.
\end{corollary}
\begin{proof}
  by \cref{lemma:subst-composition},
    $[[ σ2 ○ σ1 ]] = [[ (σ2 <=< σ1) ○ σ2 ]]$.
    Since the codomain of $[[σ1]]$ is $[[Γ'1]]$,
    and it is disjoint with the domain of $[[σ2]]$,
    $[[σ2 <=< σ1]] = [[σ1]]$.
\end{proof}

\begin{lemma}[Substitution domain weakening]
  \label{lemma:subst-domain-weakening}
  If $[[Γ2 ⊢ σ : Γ1]]$ then $[[Γ2, Γ' ⊢ σ : Γ1, Γ']]$
\end{lemma}
\begin{proof}
  If the variable $[[α±]]$ is in $[[Γ1]]$ then $[[Γ2 ⊢ [σ]α± ]]$ by assumption,
  and then $[[Γ2, Γ' ⊢ [σ]α± ]]$ by weakening.
  If the variable $[[α±]]$ is in $[[{Γ'} \ {Γ1}]]$ then $[[ [σ]α± = α± ]] \in [[Γ']] ⊆ [[Γ2, Γ']]$, 
  and thus, $[[Γ2, Γ' ⊢ α± ]]$.
\end{proof}

\begin{lemma}[Free variables after substitution]
  \label{lemma:subst-fv}
  Suppose that $[[Γ2 ⊢ σ : Γ1]]$, then
  \begin{enumerate}
    \item [$+$] for a type $[[iP]]$,
      the free variables of $[[ [σ]iP ]]$ are bounded in the following way:
     $[[fv(iP) \ {Γ1} ⊆ fv([σ]iP) ⊆ (fv(iP) \ {Γ1}) ∪ {Γ2}]]$;
    \item [$-$] for a type $[[iN]]$, 
      the free variables of $[[ [σ]iP ]]$ are bounded in the following way:
      $[[fv(iN) \ {Γ1} ⊆ fv([σ]iN) ⊆ (fv(iN) \ {Γ1}) ∪ {Γ2}]]$.
  \end{enumerate}
\end{lemma}
\begin{proof}
  We prove it by structural induction on 
  $[[iP]]$ and mutually, on $[[iN]]$.
  \begin{caseof}
    \item $[[iP = α⁺]]$\\
      If $[[α⁺ ∊ {Γ1}]]$ then $[[Γ2 ⊢ [σ]α⁺]]$, and by 
      \cref{lemma:wf-soundness}, $[[fv([σ]α⁺) ⊆ {Γ2}]]$.
      $[[fv(α⁺) \ {Γ1}]] = [[∅]]$, so $[[fv([σ]iP) \ {Γ1}  ⊆ fv([σ]α⁺)]]$
      vacuously.

      If $[[α⁺ ∉ {Γ1}]]$ then $[[ [σ]α⁺ = α⁺ ]]$, and 
      $[[fv([σ]α⁺) = {α⁺}]] = [[{α⁺} \ {Γ1}]]$.
      
    \item $[[iP = ∃nas.iQ]]$\\
      Then we need to show that $[[fv([σ]iP) = fv([σ]iQ) \ {nas}]]$
      is a subset of $[[(fv(iP) \ {Γ1}) ∪ {Γ2}]]$ and a superset of
      $[[fv(iP) \ {Γ1}]]$.
      Notice that $[[fv(iP) = fv(iQ) \ {nas}]]$ by definition.
      This way, we need to show that 
      $[[fv(iQ) \ {nas} \ {Γ1} ⊆ fv([σ]iQ) \ {nas} ⊆ (fv(iQ) \ {nas} \ {Γ1}) ∪ {Γ2}]]$,
      
      By the induction hypothesis, 
      $[[fv([σ]iQ) ⊆ (fv(iQ) \ {Γ1}) ∪ {Γ2}]]$.
      So for the second inclusion, it suffices to show that
      $[[((fv(iQ) \ {Γ1}) ∪ {Γ2}) \ {nas} ⊆ (fv(iQ) \ {nas} \ {Γ1}) ∪ {Γ2}]]$,
      which holds by set theoretical reasoning. 

      Also by the induction hypothesis,
      $[[fv(iQ) \ {Γ1} ⊆ fv([σ]iQ)]]$,
      and thus, by subtracting $[[{nas}]]$ from both sides,
      $[[fv(iQ) \ {nas} \ {Γ1} ⊆ fv([σ]iQ) \ {nas}]]$.

    \item The case $[[iN = ∀pas.iM]]$ is proved analogously.
    \item $[[iN = iP → iM]]$\\
      Then $[[fv([σ]iN) = fv([σ]iP) ∪ fv([σ]iM)]]$.
      By the induction hypothesis, 
      \begin{enumerate}
        \item $[[ fv(iP) \ {Γ1} ⊆ fv([σ]iP) ⊆ (fv(iP) \ {Γ1}) ∪ {Γ2}]]$ and
        \item $[[ fv(iM) \ {Γ1} ⊆ fv([σ]iM) ⊆ (fv(iM) \ {Γ1}) ∪ {Γ2}]]$.
      \end{enumerate}
      We unite these inclusions vertically and obtain
      $[[ fv(iP) \ {Γ1} ∪ fv(iM) \ {Γ1} ⊆ fv([σ]iN) ⊆ ((fv(iP) \ {Γ1}) ∪ {Γ2}) ∪ ((fv(iM) \ {Γ1}) ∪ {Γ2})]]$,
      which is equivalent to 
      $[[ (fv(iP) ∪ fv(iM)) \ {Γ1} ⊆ fv([σ]iN) ⊆ (fv(iP) ∪ fv(iM)) \ {Γ1} ∪ {Γ2}]]$.
      Since $[[fv(iP) ∪ fv(iM) = fv(iN)]]$, 
      $[[fv(iN) \ {Γ1} ⊆ fv([σ]iN) ⊆ (fv(iN) \ {Γ1}) ∪ {Γ2}]]$.
    \item The cases when $[[iP = ↓iM]]$ and $[[iN = ↑iQ]]$ are proved
      analogously
  \end{caseof}
\end{proof}

\begin{lemma}[Free variables of a variable image]
  \label{lemma:subst-fv-image}
  Suppose that $[[σ]]$ is an arbitrary substitution, 
  Then 
  \begin{itemize}
    \item [$+$] if $[[α± ∊ fv(iP)]]$ then $[[ fv([σ]α±) ⊆ fv([σ]iP) ]]$,
    \item [$-$] if $[[α± ∊ fv(iN)]]$ then $[[ fv([σ]α±) ⊆ fv([σ]iN) ]]$.
  \end{itemize}
\end{lemma}
\begin{proof}
  By straightforward mutual induction on $[[iP]]$ and $[[iN]]$.
\end{proof}
