\lemmaWfSoundness*
\begin{proof}
  The proof is done by a simple structural induction on 
  $[[Γ⊢ iP]]$ and mutually, $[[Γ ⊢ iN]]$.
  \begin{caseof}
    \item $[[Γ ⊢ α±]]$ means by inversion that $[[α±]] \in [[Γ]]$,
      that is, $[[α±]] = [[fv(α±) ⊆ Γ]]$.
    \item $[[Γ ⊢ iQ → iM]]$ means by inversion that
      $[[Γ ⊢ iQ]]$ and $[[Γ ⊢ iM]]$.
      Then by the induction hypothesis, $[[fv(iQ) ⊆ Γ]]$ and $[[fv(iM) ⊆ Γ]]$,
      and hence, $[[fv(iQ → iM) = fv(iQ) ∪ fv(iM)]] \subseteq [[Γ]]$.
    \item the cases when $[[iP = ↓iN']]$ or $[[iN = ↑iP']]$ are proven analogously.
    \item $[[Γ ⊢ ∀pas.iM]]$ means by inversion that $[[Γ, pas ⊢ iM]]$.
      Then by the induction hypothesis, $[[fv(iM) ⊆ Γ, pas]]$, and hence,
      $[[fv(∀pas.iM) = fv(iM) \ {pas}]] \subseteq [[{Γ, pas} \ {pas} = Γ]]$.
    \item The case $[[iP = ∃nas.iQ]]$ is proven analogously.
  \end{caseof}
\end{proof}

\lemmaWfCompleteness*
\begin{proof}
  By simple mutual induction on $[[iP]]$ and $[[iN]]$.
\end{proof}

\corollaryWfCtxtStrengthening*
\begin{proof}
  It follows from \cref{lemma:wf-ctxt-equiv} and \cref{lemma:wf-soundness}.
  \begin{itemize}
    \item [$+$] 
      By \cref{lemma:wf-soundness}, $[[fv(iP) ⊆ Γ]]$, and hence,
      $[[Γ ∩ fv iP = fv iP ]]$, which makes \cref{lemma:wf-ctxt-equiv}
      applicable fore contexts $[[Γ]]$ and $[[fv(iP)]]$.
    \item[$-$] The negative case is proven analogously.
  \end{itemize}
\end{proof}

\lemmaWfWeakening*
\begin{proof}
  By \cref{lemma:wf-soundness},
  $[[Γ1 ⊢ iP]]$ implies $[[fv(iP) ⊆ Γ1]]$,
  which means that $[[fv(iP) ⊆ Γ2]]$,
  and thus, $[[fv(iP)]] = [[fv(iP) ∩ Γ1]] = [[fv(iP) ∩ Γ2]]$.
  Then by \cref{lemma:wf-ctxt-equiv}, $[[Γ2 ⊢ iP]]$. 
  The negative case is symmetric.
\end{proof}


\lemmaWfSubst*
\begin{proof}
  We prove it by induction on $[[Γ, Γ1 ⊢ iP]]$ and mutually, on $[[Γ, Γ1 ⊢ iN]]$.
  Let us consider the last rule used in the derivation.
  \begin{caseof}
    \item \ruleref{\ottdruleWFTPVarLabel}, 
      i.e. $[[iP]]$ is $[[α⁺]]$.\\
      By inversion, $[[α⁺ ∊ {Γ, Γ1}]]$, then
      \begin{itemize}
        \item if $[[α⁺ ∊ Γ1]]$ then $[[ Γ2 ⊢ [σ]α⁺ ]]$, 
          and by weakening (\cref{lemma:wf-weakening}),
          $[[ Γ, Γ2 ⊢ [σ]α⁺ ]]$;
        \item if $[[α⁺ ∊ Γ \ Γ1]]$ then $[[ [σ]α⁺ = α⁺ ]]$,
          and by \ruleref{\ottdruleWFTPVarLabel}, $[[ Γ, Γ2 ⊢ α⁺ ]]$.
      \end{itemize}

    \item \ruleref{\ottdruleWFTShiftULabel},
      i.e. $[[iP]]$ is $[[↓iN]]$.\\
      Then $[[Γ, Γ1 ⊢ ↓iN]]$ means $[[Γ, Γ1 ⊢ iN]]$ by inversion,
      and by the induction hypothesis, $[[Γ, Γ2 ⊢ [σ]iN]]$.
      Then by  \ruleref{\ottdruleWFTShiftULabel}, $[[Γ, Γ2 ⊢ ↓[σ]iN]]$, 
      which by definition of substitution is rewritten as $[[Γ, Γ2 ⊢ [σ]↓iN]]$.

    \item \ruleref{\ottdruleWFTExistsLabel},
      i.e. $[[iP]]$ is $[[∃nas.iQ]]$.\\
      Then $[[Γ, Γ1 ⊢ ∃nas.iQ]]$ means $[[Γ, nas, Γ1 ⊢ iQ]]$ 
      by inversion, and by the induction hypothesis, 
      $[[Γ, {nas}, Γ2 ⊢ [σ]iQ]]$.
      Then by  \ruleref{\ottdruleWFTExistsLabel}, 
      $[[Γ, {nas}, Γ2 ⊢ ∃nas.[σ]iQ]]$, 
      which by definition of substitution is rewritten as 
      $[[Γ, Γ2 ⊢ [σ]∃nas.iQ]]$.

    \item The negative cases are proved symmetrically.
  \end{caseof}
\end{proof}
